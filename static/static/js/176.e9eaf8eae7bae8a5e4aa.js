webpackJsonp([176],{E78C:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=i("a3Yh"),l=i.n(s),a=i("yclV"),c=i("2hMI"),n={data:function(){return{applyTypelist:[],visibleDialog:!1,template_id:"",filterText:"",visibleList:[],defaultProps:{children:"children",label:"name"},visibleCheckedall:!1,checkedVisibleStr:[],defaultChechedArr:[],allVisibleStr:[]}},created:function(){this.initdata()},components:{},computed:{},mounted:function(){},watch:{filterText:function(e){this.$refs.tree.filter(e)}},methods:l()({initdata:function(){var e=this;Object(c._354)({}).then(function(t){1==t.data.msgNo&&(e.applyTypelist=t.data.payload)})},getImgurl:function(e){e.currentTarget.src="../../static/images/header_userimg.png",e.onerror=null},changeTempstatus:function(e,t){var i=this,s="",l="";-1==t?(s="确认删除吗？",l="删除成功"):0==t?(s="确认停用吗？",l="停用成功"):1==t&&(s="确认启用吗？",l="启用成功"),Object(a.h)(s).then(function(s){Object(c.W)({template_id:e,status:t}).then(function(e){1==e.data.msgNo?Object(a.g)("success",l):Object(a.g)("fail",e.data.message),i.initdata()})}).catch(function(){})},gotoApplytempProcess:function(e,t){this.$router.push({name:"applytempProcess",query:{template_id:e,type:t}})},changeVisible:function(e,t){this.visibleDialog=!0,this.template_id=t,this.filterText="",this.getUserRule(e)},getUserRule:function(e){var t=this;Object(c._235)({is_all:1}).then(function(i){if(1==i.data.msgNo){t.visibleList=i.data.payload;var s=i.data.payload,l=[];s.forEach(function(e){void 0!=e.children&&0!=e.children.length||(e.disabled=!0),void 0!=e.children&&e.children.forEach(function(e){l.push(e.id)})}),t.allVisibleStr=l,t.visibleList=s,0!=e?((e=e.toString().split(",")).length==l.length?t.visibleCheckedall=!0:t.visibleCheckedall=!1,t.setCheckedKeyStr(e),t.$refs.tree.setCheckedKeys(e)):(t.visibleCheckedall=!1,t.checkedVisibleStr=[],t.$refs.tree.setCheckedKeys([]))}else Object(a.g)("fail",i.data.message)})},filterNode:function(e,t){return!e||-1!==t.name.toString().indexOf(e)},changeVisibleCheckedall:function(e){e?(this.$refs.tree.setCheckedKeys(this.allVisibleStr),this.setCheckedKeyStr(this.allVisibleStr)):(this.$refs.tree.setCheckedKeys([]),this.setCheckedKeyStr([]))},visivleListChange:function(e,t){var i=[];t.checkedNodes.forEach(function(e){if(void 0==e.children){var t={};t.id=e.id,t.url=e.url,t.name=e.name,i.push(t)}}),this.checkedVisibleStr=i,this.checkedVisibleStr.length==this.allVisibleStr.length?this.visibleCheckedall=!0:this.visibleCheckedall=!1},setCheckedKeyStr:function(e){var t=[];this.visibleList.forEach(function(i){void 0!=i.children&&(t=t.concat(i.children.filter(function(t){return-1!=e.indexOf(t.id.toString())||-1!=e.indexOf(t.id)})))}),this.checkedVisibleStr=t},compare:function(e){return function(t,i){return t[e]-i[e]}},deleteCheckedVisivle:function(e){var t=this;this.checkedVisibleStr.forEach(function(i,s){e==i.id&&t.checkedVisibleStr.splice(s,1)});var i=[];this.checkedVisibleStr.forEach(function(e,t){i.push(e.id)}),this.checkedVisibleStr.length==this.allVisibleStr.length?this.visibleCheckedall=!0:this.visibleCheckedall=!1,this.$refs.tree.setCheckedKeys(i)},commitVisible:function(){var e=this,t="";0==this.checkedVisibleStr.length||this.checkedVisibleStr.length==this.allVisibleStr.length?t=0:(t=[],this.checkedVisibleStr.forEach(function(e){t.push(e.id)})),t=t.toString(),Object(c._372)({template_id:this.template_id,visible:t}).then(function(t){1==t.data.msgNo?(Object(a.g)("success","修改成功！"),e.visibleDialog=!1,e.initdata()):Object(a.g)("info",t.data.message)})},gotoCreatetemp:function(){this.$router.push({name:"createApplyTemp"})},visibleClose:function(){this.template_id="",this.checkedVisibleStr=[],this.$refs.tree.setCheckedKeys([]),this.visibleCheckedall=!1,this.visibleDialog=!1}},"getImgurl",function(e){e.currentTarget.src="../../static/images/header_userimg.png",e.onerror=null})},r={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"personal-content-body"},[i("div",{staticClass:"content"},[e._m(0),e._v(" "),i("div",{staticClass:"clear table-group-title"},[i("div",{staticClass:"left breadcrumb"},[i("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[i("el-breadcrumb-item",{attrs:{to:{name:"administrativeManageHomepage"}}},[e._v("行政管理")]),e._v(" "),i("el-breadcrumb-item",[e._v("审批配置")])],1)],1),e._v(" "),i("div",{staticClass:"right"}),e._v(" "),i("div",{staticClass:"line"})]),e._v(" "),i("div",{staticClass:"applytemp_body"},e._l(e.applyTypelist,function(t){return i("div",{staticClass:"applytemp_group"},[i("div",{staticClass:"applytemp_group_title"},[i("div",{staticClass:"applytemp_group_title_left"},[e._v("\n            "+e._s(t.className)),i("span",{staticClass:"fcolor_gray"},[e._v("（"+e._s(t.data.length)+"）")])])]),e._v(" "),i("div",{staticClass:"applytemp_list"},e._l(t.data,function(t){return i("div",{staticClass:"applytemp_item"},[i("div",{staticClass:"applytemp_item_row flex"},[i("img",{staticClass:"applytemp_item_img",attrs:{src:t.icon}}),e._v(" "),i("div",{staticClass:"flex_column flex_grow"},[i("div",{staticClass:"fsize_15 lineheight_1.5"},[e._v(e._s(t.name))]),e._v(" "),i("div",{staticClass:"fsize_12 fcolor_gray_85 applytemp_item_ellipsis lineheight_2"},[e._v("\n                  "+e._s(t.description)+"\n                ")]),e._v(" "),i("div",{staticClass:"fsize_12 fcolor_gray_85 lineheight_2"},[e._v(e._s(t.update_time)+" 更新")])]),e._v(" "),i("div",{staticClass:"line"})]),e._v(" "),i("div",{staticClass:"applytemp_item_row flex flex_grow"},[i("div",{staticClass:"fsize_14 flex_column flex_grow"},[i("div",{staticClass:"fsize_12 lineheight_2"},[e._v("可见范围")]),e._v(" "),i("div",{staticClass:"fsize_12 fcolor_gray_85"},[0==t.visible?i("span",{staticClass:"marginr_5 fcolor_gray_85 lineheight_2"},[e._v("全部可见")]):e._e(),e._v(" "),0!=t.visible?i("span",{staticClass:"marginr_5 fcolor_gray_85 lineheight_2"},[e._v("部分可见")]):e._e(),e._v(" "),i("span",{staticClass:"applytemp_item_link lineheight_2",on:{click:function(i){e.changeVisible(t.visible,t.template_id)}}},[e._v("修改")])])]),e._v(" "),i("div",{staticClass:"line"})]),e._v(" "),i("div",{staticClass:"applytemp_item_row flex flex_grow"},[i("div",{staticClass:"fsize_12 applytemp_item_link marginr_5",on:{click:function(i){e.gotoApplytempProcess(t.template_id,t.type)}}},[e._v("审批流程")]),e._v(" "),0==t.status?i("div",{staticClass:"fsize_12 applytemp_item_link marginr_5",on:{click:function(i){e.changeTempstatus(t.template_id,1)}}},[e._v("启用")]):e._e(),e._v(" "),1==t.status?i("div",{staticClass:"fsize_12 applytemp_item_link marginr_5",on:{click:function(i){e.changeTempstatus(t.template_id,0)}}},[e._v("停用")]):e._e(),e._v(" "),i("div",{staticClass:"fsize_12 applytemp_item_link marginr_5",on:{click:function(i){e.changeTempstatus(t.template_id,-1)}}},[e._v("删除")])])])}))])})),e._v(" "),i("el-dialog",{staticClass:"choosePeopleDialog",attrs:{title:"设置可见人员",visible:e.visibleDialog,width:"800px",center:"","append-to-body":!0,"before-close":e.visibleClose},on:{"update:visible":function(t){e.visibleDialog=t}}},[i("div",{staticClass:"dialog_content flex"},[i("div",{staticClass:"dialog_content_content"},[i("div",{staticClass:"dialog_content_content_title"},[e._v("选择人员")]),e._v(" "),i("div",[i("el-input",{attrs:{placeholder:"输入关键字进行过滤"},model:{value:e.filterText,callback:function(t){e.filterText=t},expression:"filterText"}},[i("i",{staticClass:"el-input__icon el-icon-search",attrs:{slot:"prefix"},slot:"prefix"})])],1),e._v(" "),i("div",{staticClass:"custom_tree_node flex"},[i("el-checkbox",{on:{change:e.changeVisibleCheckedall},model:{value:e.visibleCheckedall,callback:function(t){e.visibleCheckedall=t},expression:"visibleCheckedall"}},[e._v("全选")])],1),e._v(" "),i("el-tree",{ref:"tree",staticClass:"dialog_content_content_tree",attrs:{data:e.visibleList,"show-checkbox":"","node-key":"id","default-checked-keys":e.defaultChechedArr,"filter-node-method":e.filterNode,props:e.defaultProps},on:{check:e.visivleListChange},scopedSlots:e._u([{key:"default",fn:function(t){var s=t.node;return t.data,i("span",{staticClass:"custom_tree_node flex"},[void 0!=s.data.url?i("img",{attrs:{src:s.data.url},on:{error:e.getImgurl}}):e._e(),e._v("\n            "+e._s(s.data.name)+"\n          ")])}}])})],1),e._v(" "),i("div",{staticClass:"dialog_content_content"},[i("div",{staticClass:"dialog_content_content_title"},[e._v("已选人员")]),e._v(" "),i("div",{staticClass:"selected_list"},e._l(e.checkedVisibleStr,function(t){return i("div",{staticClass:"selected_item"},[i("img",{staticClass:"selected_item_headimg",attrs:{src:t.url},on:{error:e.getImgurl}}),e._v(e._s(t.name)+"\n              "),i("i",{staticClass:"el-icon-error",on:{click:function(i){e.deleteCheckedVisivle(t.id)}}})])}))])]),e._v(" "),i("div",{staticClass:"dialog_footer clear",attrs:{slot:"footer"},slot:"footer"},[i("button",{staticClass:"dialog-btn-submit btn-blue",on:{click:e.commitVisible}},[e._v("确定")]),e._v(" "),i("button",{staticClass:"dialog-btn-submit btn-blue-border ",on:{click:e.visibleClose}},[e._v("取消")])])])],1)])},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"content-title clear"},[t("div",{staticClass:"left"},[this._v("审批模版列表")])])}]};var o=i("C7Lr")(n,r,!1,function(e){i("kXkv")},"data-v-2b257f3a",null);t.default=o.exports},kXkv:function(e,t){}});
//# sourceMappingURL=176.e9eaf8eae7bae8a5e4aa.js.map