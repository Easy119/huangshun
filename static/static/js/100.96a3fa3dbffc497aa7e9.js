webpackJsonp([100],{"6xiW":function(t,i){},"8uAk":function(t,i,e){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var n=e("HzJ8"),a=e.n(n),o=e("3cXf"),s=e.n(o),c=e("2hMI"),l=e("lKYg"),r=e("yclV"),m=(e("9rMa"),{data:function(){return{oldSelectcompnay:[],needChangeId:!0,editorconfirm:!1,companyList:[],loading:!1,commitData:{title:"",company:"",content:""},totalCompanyList:[],positionList:[],selectCompanyId:"",selectPositionId:"",selectCompanyList:[],historyFile:[],newFile:[],currentspan:"",editorOption:{modules:{toolbar:[["bold","italic"],[{header:1}],[{list:"ordered"},{list:"bullet"}],[{size:["small",!1,"large","huge"]}],[{color:[]}],[{align:[]}],["clean"],["link","image"]],syntax:{highlight:function(t){return hljs.highlightAuto(t).value}}},placeholder:""}}},components:{progressBar:l.a},computed:{submitOk:function(){if(""!=this.commitData.title){return""!=this.$refs.ueditor.getContent()}return!1}},mounted:function(){void 0!=this.$route.query.aif&&(this.editorconfirm=!0);var t=this.$refs.ueditor;t.setContent(this.commitData.content),t.upload=function(i,e){var n=i.files[0],a=new Image,o=(document.createElement("canvas").getContext("2d"),new FileReader);o.readAsDataURL(n),o.onload=function(){a.src=this.result;var i="<img src='"+this.result+"'>";i=t.getContent()+i,t.setContent(i),e("")}}},created:function(){},methods:{showCompanyInfo:function(){var t=this;Object(c._208)({company_id:this.selectCompanyId}).then(function(i){1==i.data.msgNo?(t.positionList=i.data.payload,t.selectPositionId=""):Object(r.g)("info",i.data.message)})},addSelectCompanyList:function(){var t=this;if(""==this.selectPositionId)Object(r.g)("info","请先选择职位");else{var i={companyInfo:{},positionArr:[]},e={},n=!0,a=!1;if(this.positionList.forEach(function(i){i.position_id==t.selectPositionId&&(null==(e=JSON.parse(s()(i))).name||void 0==e.name?(Object(r.g)("info","该职位还未安排人员"),a=!0):e.name=e.name.split(","))}),a)return!1;this.selectCompanyList.forEach(function(i){if(i.companyInfo.id==t.selectCompanyId){n=!1;var a=!0;i.positionArr.forEach(function(i){i.position_id==t.selectPositionId&&(a=!1,Object(r.g)("info","该职位已添加!"))}),a&&i.positionArr.push(e)}}),n&&(this.totalCompanyList.forEach(function(n){n.id==t.selectCompanyId&&(i.companyInfo=n,i.positionArr.push(e))}),this.selectCompanyList.push(i)),this.selectCompanyId="",this.selectPositionId="",this.positionList=[]}},deleteSelectCompanyList:function(t,i){this.selectCompanyList.splice(i,1)},deleteOnePosition:function(t,i){t.splice(i,1)},initData:function(){var t=this;Object(c._12)().then(function(i){if(1==i.data.msgNo){var e=i.data.payload;t.totalCompanyList=e,void 0!=t.$route.query.aif&&t.getNewsDetail()}})},addFile:function(t){var i=!0,e=!1,n=void 0;try{for(var o,s=a()(t.target.files);!(i=(o=s.next()).done);i=!0){var c=o.value,l=!0,r=!0,m=!1,f=void 0;try{for(var d,u=a()(this.newFile);!(r=(d=u.next()).done);r=!0){d.value.name==c.name&&(l=!1)}}catch(t){m=!0,f=t}finally{try{!r&&u.return&&u.return()}finally{if(m)throw f}}l&&this.newFile.push(c)}}catch(t){e=!0,n=t}finally{try{!i&&s.return&&s.return()}finally{if(e)throw n}}t.target.value=""},remoteMethod:function(t){var i=this;""!==t?(this.loading=!0,setTimeout(function(){if(i.loading=!1,i.companyList=i.totalCompanyList.filter(function(i){return i.name.indexOf(t)>-1}),i.companyList.length>0)for(var e in i.commitData.companyId){var n=!0,o=!1,s=void 0;try{for(var c,l=a()(i.companyList);!(n=(c=l.next()).done);n=!0){var r=c.value;r.name==i.commitData.companyId[e]&&(i.commitData.companyId[e]=r.id)}}catch(t){o=!0,s=t}finally{try{!n&&l.return&&l.return()}finally{if(o)throw s}}}},200)):this.companyList=[]},getNewsDetail:function(){var t=this;Object(c._326)({aif:this.$route.query.aif}).then(function(i){if(1==i.data.msgNo){var e=i.data.payload;t.commitData.title=e.info.title,t.commitData.content=e.info.contents,t.editorconfirm&&""!=e.info.adjunct&&(t.commitData.adjunct=JSON.parse(e.info.adjunct));var n=[];e.company.forEach(function(t){var i={companyInfo:{},positionArr:[]};i.companyInfo.name=t.company_name,i.companyInfo.id=t.company_id,(null!=t.position_id&&""!=t.position_id||void 0!=t.position_id)&&(t.pasition_arr.forEach(function(t){""!=t.name&&null!=t.name?t.name=t.name.split(","):t.name=[]}),i.positionArr=t.pasition_arr),n.push(i)}),t.selectCompanyList=n}})},commitClick:function(){var t=this,i=this.$refs.ueditor;if(this.commitData.content=i.getContent(),""==this.commitData.content&&(this.submitOk=!1),this.submitOk){var e={title:this.commitData.title,contents:this.commitData.content};Object(c._307)(e,this.newFile).then(function(e){1==e.data.msgNo?(Object(r.g)("success","发布成功"),t.commitData={title:"",company:"",content:""},i.setContent(""),t.newFile=[]):Object(r.g)("info",e.data.message)})}else Object(r.g)("info","您还有必填项没有填写！")},changeCommitClick:function(){var t=this;if(this.submitOk){var i="",e={title:this.commitData.title,contents:this.commitData.content,aif:this.$route.query.aif};void 0!=this.commitData.adjunct&&(e.adjunct=s()(this.commitData.adjunct)),0!=this.selectCompanyList.length&&(i=[],this.selectCompanyList.forEach(function(t){var e={};e.company_id=t.companyInfo.id;var n=[];t.positionArr.forEach(function(t){n.push(t.position_id)}),e.position_id=n.join(","),i.push(e)}),e.company=s()(i)),Object(c._89)(e,this.newFile).then(function(i){1==i.data.msgNo&&(Object(r.g)("success","编辑成功"),t.goNewList())})}else Object(r.g)("info","您还有必填项没有填写！")},changeOldFile:function(t,i){var e=JSON.parse(s()(this.commitData.adjunct));delete e[t],this.commitData.adjunct=e;var n=!0,o=!1,c=void 0;try{for(var l,r=a()(i.target.files);!(n=(l=r.next()).done);n=!0){var m=l.value;this.newFile.push(m)}}catch(t){o=!0,c=t}finally{try{!n&&r.return&&r.return()}finally{if(o)throw c}}i.target.value=""},deleteOldFile:function(t){var i=JSON.parse(s()(this.commitData.adjunct));delete i[t],this.commitData.adjunct=i},changeNewFile:function(t,i){this.newFile.splice(t,1);var e=!0,n=!1,o=void 0;try{for(var s,c=a()(i.target.files);!(e=(s=c.next()).done);e=!0){var l=s.value;this.newFile.push(l)}}catch(t){n=!0,o=t}finally{try{!e&&c.return&&c.return()}finally{if(n)throw o}}i.target.value=""},deleteNewFile:function(t){this.newFile.splice(t,1)},goNewList:function(){this.$router.push({path:"/home/investedPublishNews"})}}}),f={render:function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("div",{staticClass:"personal-content-body"},[e("div",{staticClass:"content investPersonaInfoPublish scroll-style"},[e("div",{staticClass:"content-title clear"}),t._v(" "),e("div",{staticClass:"content-body clear"},[e("div",{staticClass:"content-body-left-box left"},[e("div",{staticClass:"content-body-left-box-content"},[e("div",{staticClass:"content-part-box"},[e("div",{staticClass:"content-part-body"},[e("div",{staticClass:"form-group from-inputbox clear"},[t._m(0),t._v(" "),e("div",{staticClass:"form-input left"},[e("el-input",{staticClass:"header-right-time input-position",attrs:{placeholder:"请输入文章标题",clearable:!0},model:{value:t.commitData.title,callback:function(i){t.$set(t.commitData,"title",i)},expression:"commitData.title"}})],1)]),t._v(" "),e("div",{staticClass:"form-group from-inputbox clear form-editorbox"},[t._m(1),t._v(" "),e("div",{staticClass:"form-input left"},[e("Vueditor",{ref:"ueditor",staticClass:"form-editor"})],1)]),t._v(" "),e("div",{staticClass:"form-group from-inputbox clear"},[t._m(2),t._v(" "),e("div",{staticClass:"form-input form-filebox left"},[e("div",{staticClass:"file-list"},[t._l(t.commitData.adjunct,function(i,n){return t.editorconfirm?e("div",{key:n,staticClass:"file-item"},[e("div",{staticClass:"file-name"},[e("div",[t._v(t._s(n))])]),t._v(" "),e("a",{staticClass:"formgroup-file-item-btn right"},[e("input",{staticClass:"formgroup-file-item-btn-inputfile",attrs:{type:"file",multiple:"multiple"},on:{change:function(i){t.changeOldFile(n,i)}}}),t._v("替换")]),t._v(" "),e("div",{staticClass:"file-click file-click-del",on:{click:function(i){t.deleteOldFile(n)}}},[t._v("删除")])]):t._e()}),t._v(" "),t._l(t.newFile,function(i,n){return e("div",{key:n,staticClass:"file-item"},[e("div",{staticClass:"file-name"},[e("div",[t._v(t._s(i.name))])]),t._v(" "),e("a",{staticClass:"formgroup-file-item-btn right"},[e("input",{staticClass:"formgroup-file-item-btn-inputfile",attrs:{type:"file",multiple:"multiple"},on:{change:function(i){t.changeNewFile(n,i)}}}),t._v("替换")]),t._v(" "),e("div",{staticClass:"file-click file-click-del",on:{click:function(i){t.deleteNewFile(n)}}},[t._v("删除")])])})],2),t._v(" "),e("div",{staticClass:"file-add"},[e("input",{staticClass:"file-add-input",attrs:{type:"file",multiple:"multiple"},on:{change:function(i){t.addFile(i)}}}),t._v(" "),e("i",{staticClass:"el-icon-plus"}),t._v("添加文件\n\t\t\t\t\t\t\t\t\t\t")])])])])]),t._v(" "),e("div",{staticClass:"content-confirm clear"},[0==t.editorconfirm?e("div",{staticClass:"content-confirm-btn btn-blue",class:{"btn-blue-disabled":!t.submitOk},on:{click:t.commitClick}},[t._v("发布")]):t._e()])])])])])])},staticRenderFns:[function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("div",{staticClass:"form-title left"},[e("em",{staticClass:"red"},[t._v("*")]),t._v(" "),e("em",[t._v("公")]),t._v(" "),e("em",[t._v("告")]),t._v(" "),e("em",[t._v("标")]),t._v(" "),e("em",[t._v("题")])])},function(){var t=this.$createElement,i=this._self._c||t;return i("div",{staticClass:"form-title left"},[i("em",{staticClass:"red"},[this._v("*")]),this._v(" "),i("em",[this._v("正")]),this._v(" "),i("em",[this._v("文")])])},function(){var t=this.$createElement,i=this._self._c||t;return i("div",{staticClass:"form-title left"},[i("em",[this._v("附")]),this._v(" "),i("em",[this._v("件")])])}]};var d=e("C7Lr")(m,f,!1,function(t){e("6xiW")},"data-v-6d6bbca2",null);i.default=d.exports}});
//# sourceMappingURL=100.96a3fa3dbffc497aa7e9.js.map