webpackJsonp([95],{jQ87:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=a("3cXf"),o=a.n(i),s=a("2hMI"),l=a("yclV"),r={data:function(){return{type:0,company_id:"",pageSize:10,searchText:"",datalist:[],total:10,currentPage:1,fileuploadDialog:!1,ruleDialog:!1,leader:[],dialogParam:{name:"",phone:"",leader:"",depart_id:"",position:"",entryTime:"",email:""},phoneErrorMsg:"",emailErrorMsg:"",ruleList:[],defaultProps:{children:"child",label:"node_name"},defaultChechedArr:[],dialogTitle:"",selectData:[],isAllChecked:!1,innerVisible:!1,default_ids:[],departmentNames:"",departmentData:[],defaultPropsDepartment:{children:"children",label:"name"}}},created:function(){this.$route.query.from?this.from="":this.from=this.$route.query.from,this.initData()},methods:{getDepartmentData:function(){var t=this;Object(s._149)({type:""}).then(function(e){console.log(e),1==e.data.msgNo?t.departmentData=e.data.payload:Object(l.g)("info",e.data.message)})},getChoosedIdAndName:function(){var t=this.$refs.treeDepartment.getCheckedKeys();console.log(t),this.dialogParam.depart_id=t.join(",");var e=this.$refs.treeDepartment.getCheckedNodes();console.log(e);var a=[];for(var i in e)a.push(e[i].name);this.departmentNames=a.join(",")},getSelectDepartment:function(){this.getChoosedIdAndName(),this.innerVisible=!1},departmentChooseChange:function(t,e){this.getChoosedIdAndName()},makeDepartmentShow:function(){this.innerVisible=!0;var t;t=this.dialogParam.depart_id.split(","),this.default_ids=t},editorInfo:function(t){this.getUserInfo(t.id),this.getDepartmentData(),this.fileuploadDialog=!0,"-- -- -- --"==t.entryTime&&(t.entryTime=""),null!=t.email&&void 0!=t.email||(t.email=""),this.departmentNames=t.departName,this.dialogParam={user_id:t.id,name:t.name,phone:t.phone,leader:t.leader,depart_id:t.depart_id,position:t.position,entryTime:t.entryTime,email:t.email},this.phoneErrorMsg="",this.emailErrorMsg="",this.dialogTitle="编辑员工信息"},createUser:function(){this.getDepartmentData(),this.getUserInfo(),this.fileuploadDialog=!0,this.departName="",this.dialogParam={name:"",phone:"",email:"",leader:"",depart_id:"",position:"",entryTime:""},this.phoneErrorMsg="",this.emailErrorMsg="",this.dialogTitle="添加新员工"},deleteEmployee:function(){var t=this,e=this.selectData.join(",");console.log(e),e&&Object(l.h)("确定要删除所选人员吗？").then(function(){Object(s._280)({id:e,type:-1}).then(function(e){1==e.data.msgNo?(Object(l.g)("success","删除成功"),t.getDatalist()):Object(l.g)("fail","修改失败")})}).catch(function(){})},handleSelectionChange:function(t){console.log(t);for(var e=[],a=0,i=t.length;a<i;a++)e.push(t[a].id);this.selectData=e},changeCurrentPage:function(t){this.currentPage=t,this.getDatalist()},everyPageSizeChange:function(t){this.pageSize=t,this.getDatalist()},checkedAll:function(){var t=this;this.isAllChecked?(t.selectData=[],t.datalist.forEach(function(e){t.selectData.push(e.id)})):t.selectData=[]},initData:function(){this.currentPage=1,this.getDatalist()},getDatalist:function(){var t=this;this.isAllChecked=!1,this.selectData=[],Object(s._367)({page:this.currentPage,number:this.pageSize,search:this.searchText}).then(function(e){if(1==e.data.msgNo){var a=e.data.payload.data;a.forEach(function(t){null==t.entryTime?t.entryTime="-- -- -- --":t.entryTime=t.entryTime.split(" ")[0],null==t.leadername&&(t.leadername="--"),null==t.departName&&(t.departName="--"),""!=t.dimission&&null!=t.dimission&&(t.dimission=t.dimission.split(" ")[0]),""!=t.frozenTime&&null!=t.frozenTime&&(t.frozenTime=t.frozenTime.split(" ")[0])}),t.datalist=a,t.total=e.data.payload.total}})},changestatus:function(t,e){var a=this,i="",o="";2==e?(i="离职后该人员下的所属项目、基金和下级人员将自动转接给上级。确定要离职吗？",o="已离职!"):1==e?(i="确定要恢复该人员吗？",o="已恢复!"):-1==e?(i="删除后该人员下的所属项目、基金和下级人员将自动转接给上级。确定要删除该人员吗？",o="已删除!"):4==e&&(i="确定要冻结该人员吗？",o="已冻结!"),Object(l.h)(i).then(function(){Object(s._280)({id:t,type:e}).then(function(t){1==t.data.msgNo?Object(l.g)("success",o):Object(l.g)("fail","修改失败"),a.getDatalist()})}).catch(function(){})},currentChange:function(t){this.total>this.pageSize&&(this.datalist=[],this.currentPage=t,this.getDatalist())},getUserInfo:function(t){var e=this,a={};void 0!=t&&(a={id:t}),Object(s.F)(a).then(function(t){if(1==t.data.msgNo){e.leader=t.data.payload.leader,e.leader.unshift({id:0,name:"无"})}})},dialogClose:function(){var t=this,e=this.dialogParam;""!=e.name||""!=e.phone||""!=e.email||""!=e.leader||""!=e.depart_id||""!=e.position||""!=e.entryTime?Object(l.h)("确定放弃修改吗？").then(function(){t.fileuploadDialog=!1}).catch(function(){}):this.fileuploadDialog=!1},submitClick:function(){var t=this;if(this.submitOk){var e=JSON.parse(o()(this.dialogParam));""==e.leader&&(e.leader=0),Object(s.E)(e).then(function(a){1==a.data.msgNo?(void 0==e.user_id?Object(l.g)("success","员工信息添加成功!"):Object(l.g)("success","员工信息编辑成功!"),t.fileuploadDialog=!1,t.getDatalist()):Object(l.g)("fail",a.data.message)})}},checkPhone:function(){this.phoneError&&""!=this.dialogParam.phone&&(this.phoneErrorMsg="手机号格式错误")},checkEmail:function(){this.emailError&&""!=this.dialogParam.email&&(this.emailErrorMsg="邮箱格式错误")},getUserRule:function(t){var e=this;this.setRuleId=t.id,Object(s._238)({user_id:t.id}).then(function(t){if(1==t.data.msgNo){e.ruleList=t.data.payload,e.defaultChechedArr=[];var a=[];e.ruleList.forEach(function(t){1==t.is_select&&e.defaultChechedArr.push(t.id),void 0!=t.child&&t.child.forEach(function(i){1==i.is_select?e.defaultChechedArr.push(i.id):0==i.is_select&&-1==a.indexOf(t.id)&&a.push(t.id),void 0!=i.child&&i.child.forEach(function(t){1==t.is_select?e.defaultChechedArr.push(t.id):0==t.is_select&&-1==a.indexOf(i.id)&&a.push(i.id)})})}),e.ruleDialog=!0}else Object(l.g)("info",t.data.message)})},commitRule:function(){var t=this,e=this.$refs.tree.getCheckedKeys();e.forEach(function(a){t.ruleList.forEach(function(t){void 0!=t.child&&t.child.forEach(function(i){i.id==a?-1==e.indexOf(t.id)&&e.push(t.id):void 0!=i.child&&i.child.forEach(function(t){t.id==a&&-1==e.indexOf(i.id)&&e.push(i.id)})})})}),e=e.join(","),Object(s._114)({user_id:this.setRuleId,rule:e}).then(function(e){1==e.data.msgNo?(Object(l.g)("success","权限设置成功！"),t.ruleDialog=!1):Object(l.g)("info",e.data.message)})},ruleClose:function(){this.ruleDialog=!1}},computed:{nameError:function(){return""==this.dialogParam.name},phoneError:function(){return""==this.dialogParam.phone||!/^1\d{10}$/gi.test(this.dialogParam.phone)},emailError:function(){return""==this.dialogParam.email||!/^([a-zA-Z0-9_\.\-])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/.test(this.dialogParam.email)},positionError:function(){return""==this.dialogParam.position},depart_id_Error:function(){return""==this.dialogParam.depart_id},submitOk:function(){return!(this.nameError||this.phoneError||this.emailError||this.positionError||this.depart_id_Error)}},mounted:function(){},watch:{}},n={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"personal-content-body"},[i("div",{staticClass:"table-content"},[i("div",{staticClass:"table-group"},[i("div",{staticClass:"table-group-content"},[i("div",{staticClass:"clear table-group-title"},[i("el-input",{staticClass:"header-right-time left",attrs:{placeholder:"搜索",clearable:!0},on:{change:function(e){t.initData()}},model:{value:t.searchText,callback:function(e){t.searchText=e},expression:"searchText"}},[i("i",{staticClass:"el-input__icon el-icon-search ",attrs:{slot:"prefix"},slot:"prefix"})]),t._v(" "),i("div",{staticClass:"right flex_end"},[i("div",{staticClass:"cursor table_group_title_delete",on:{click:t.deleteEmployee}},[t._v("\n\t\t\t\t\t\t\t\t删除\n\t\t\t\t\t\t\t")]),t._v(" "),i("div",{staticClass:"table-group-title-btn btn-blue",on:{click:t.createUser}},[i("span",{staticClass:"iconfont icon-jia"}),t._v("添加新员工\n\t\t\t\t\t\t\t")])])],1),t._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:0==t.type,expression:"type==0"}],staticClass:"historyapply-group-tablebox table-group-tablebox"},[i("div",{staticClass:"table-normal-box table"},[i("el-table",{ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:t.datalist,border:""},on:{"selection-change":t.handleSelectionChange}},[i("el-table-column",{attrs:{type:"selection",width:"55"}}),t._v(" "),i("el-table-column",{attrs:{prop:"id",label:"序号",width:"100",sortable:""},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n\t\t\t\t\t\t\t\t\t\t"+t._s(e.$index+1+(t.currentPage-1)*t.pageSize)+"\n\t\t\t\t\t\t\t\t\t")]}}])}),t._v(" "),i("el-table-column",{attrs:{prop:"name",label:"人员",width:"150",sortable:""}}),t._v(" "),i("el-table-column",{attrs:{prop:"leadername",label:"上级领导",width:"200",sortable:""}}),t._v(" "),i("el-table-column",{attrs:{prop:"departName",label:"部门",width:"180",sortable:""}}),t._v(" "),i("el-table-column",{attrs:{prop:"position",label:"职位",width:"180",sortable:""}}),t._v(" "),i("el-table-column",{attrs:{prop:"entryTime",label:"入职时间",width:"180",sortable:""}}),t._v(" "),i("el-table-column",{attrs:{prop:"invest_evaluate",label:"状态",width:"120",sortable:""},scopedSlots:t._u([{key:"default",fn:function(e){return[1==e.row.status?i("div",{},[t._v("\n\t\t\t\t\t\t\t\t\t\t\t正常\n\t\t\t\t\t\t\t\t\t\t")]):2==e.row.status?i("div",{},[t._v("\n\t\t\t\t\t\t\t\t\t\t\t"+t._s(e.row.dimission)+"离职\n\t\t\t\t\t\t\t\t\t\t")]):i("div",{},[t._v("\n\t\t\t\t\t\t\t\t\t\t\t"+t._s(e.row.frozenTime)+"冻结\n\t\t\t\t\t\t\t\t\t\t")])]}}])}),t._v(" "),i("el-table-column",{attrs:{fixed:"right",label:"操作",width:"250"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("div",{},[1==e.row.status?i("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){t.changestatus(e.row.id,2)}}},[t._v("离职")]):t._e(),t._v(" "),1==e.row.status?i("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){t.changestatus(e.row.id,4)}}},[t._v("冻结")]):t._e(),t._v(" "),4==e.row.status?i("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){t.changestatus(e.row.id,1)}}},[t._v("恢复")]):t._e(),t._v(" "),i("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){t.changestatus(e.row.id,-1)}}},[t._v("删除")]),t._v(" "),i("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){t.editorInfo(e.row)}}},[t._v("编辑")]),t._v(" "),i("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){t.getUserRule(e.row)}}},[t._v("设置权限")])],1)]}}])}),t._v(" "),i("template",{slot:"empty"},[i("div",{staticClass:"table-nodata flex_start"},[i("img",{attrs:{src:a("urJZ")}}),t._v(" "),i("span",[t._v("没有对应数据")])])])],2)],1),t._v(" "),t.total?i("div",{},[i("el-pagination",{attrs:{"prev-text":"上一页","next-text":"下一页",background:"","current-page":t.currentPage,"page-size":t.pageSize,layout:"sizes, prev, pager, next, jumper",total:t.total},on:{"size-change":t.everyPageSizeChange,"current-change":t.changeCurrentPage}})],1):t._e()])])]),t._v(" "),i("el-dialog",{attrs:{title:t.dialogTitle,visible:t.fileuploadDialog,width:"900px",center:"","append-to-body":!0,"before-close":t.dialogClose},on:{"update:visible":function(e){t.fileuploadDialog=e}}},[i("div",{staticClass:"dialog_content"},[i("div",{staticClass:"form-group margin-bottom-none"},[i("div",{staticClass:"form-group-inputboxgroup"},[i("div",{staticClass:"form-group-inputbox"},[i("h2",{staticClass:"form-group-inputbox-title"},[i("span",{staticClass:"account-icon icon-required"}),t._v("姓名")]),t._v(" "),i("div",{staticClass:"form-group-inputbox-selectbox select-normal-40 left"},[i("el-input",{staticClass:"header-right-time right",attrs:{placeholder:"请输入员工姓名",clearable:!0},model:{value:t.dialogParam.name,callback:function(e){t.$set(t.dialogParam,"name",e)},expression:"dialogParam.name"}})],1),t._v(" "),i("span",{staticClass:"form-group-inputbox-error"})]),t._v(" "),i("div",{staticClass:"form-group-inputbox"},[i("h2",{staticClass:"form-group-inputbox-title"},[i("span",{staticClass:"account-icon icon-required"}),t._v("手机号")]),t._v(" "),i("div",{staticClass:"form-group-inputbox-selectbox select-normal-40 left"},[i("el-input",{staticClass:"header-right-time right",attrs:{placeholder:"请输入手机号",clearable:!0,maxLength:"11"},on:{change:t.checkPhone},model:{value:t.dialogParam.phone,callback:function(e){t.$set(t.dialogParam,"phone",e)},expression:"dialogParam.phone"}})],1),t._v(" "),t.phoneError?i("span",{staticClass:"form-group-inputbox-error"},[t._v(t._s(t.phoneErrorMsg))]):t._e()])]),t._v(" "),i("div",{staticClass:"form-group-inputboxgroup"},[i("div",{staticClass:"form-group-inputbox"},[i("h2",{staticClass:"form-group-inputbox-title"},[t._v("上级领导")]),t._v(" "),i("div",{staticClass:"form-group-inputbox-selectbox select-normal-40 left"},[i("el-select",{attrs:{placeholder:"请选择"},model:{value:t.dialogParam.leader,callback:function(e){t.$set(t.dialogParam,"leader",e)},expression:"dialogParam.leader"}},t._l(t.leader,function(t){return i("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})}))],1),t._v(" "),i("span",{staticClass:"form-group-inputbox-error"})]),t._v(" "),i("div",{staticClass:"form-group-inputbox"},[i("h2",{staticClass:"form-group-inputbox-title"},[i("span",{staticClass:"account-icon icon-required"}),t._v("职位")]),t._v(" "),i("div",{staticClass:"form-group-inputbox-selectbox select-normal-40 left"},[i("el-input",{staticClass:"header-right-time right",attrs:{placeholder:"请输入职位",clearable:!0},model:{value:t.dialogParam.position,callback:function(e){t.$set(t.dialogParam,"position",e)},expression:"dialogParam.position"}})],1),t._v(" "),i("span",{staticClass:"form-group-inputbox-error"})])]),t._v(" "),i("div",{staticClass:"form-group-inputboxgroup"},[i("div",{staticClass:"form-group-inputbox"},[i("h2",{staticClass:"form-group-inputbox-title"},[i("span",{staticClass:"account-icon icon-required"}),t._v("所属部门")]),t._v(" "),i("div",{staticClass:"form-group-inputbox-selectbox select-normal-40 left"},[i("el-input",{staticClass:"header-right-time right",attrs:{placeholder:"请输入部门",clearable:!0},on:{focus:t.makeDepartmentShow},model:{value:t.departmentNames,callback:function(e){t.departmentNames=e},expression:"departmentNames"}}),t._v(" "),i("el-dialog",{attrs:{width:"30%",title:"所属部门",center:"",visible:t.innerVisible,"append-to-body":""},on:{"update:visible":function(e){t.innerVisible=e}}},[i("el-tree",{ref:"treeDepartment",attrs:{data:t.departmentData,"default-checked-keys":t.default_ids,"show-checkbox":"","node-key":"id",props:t.defaultPropsDepartment,"check-strictly":""},on:{"check-change":t.departmentChooseChange}}),t._v(" "),i("div",{staticClass:"dialog_footer clear",attrs:{slot:"footer"},slot:"footer"},[i("button",{staticClass:"dialog-btn-submit btn-blue",on:{click:t.getSelectDepartment}},[t._v("确定")]),t._v(" "),i("button",{staticClass:"dialog-btn-submit btn-blue-border ",on:{click:function(e){t.innerVisible=!1}}},[t._v("取消")])])],1)],1),t._v(" "),i("span",{staticClass:"form-group-inputbox-error"})]),t._v(" "),i("div",{staticClass:"form-group-inputbox"},[i("h2",{staticClass:"form-group-inputbox-title"},[t._v("入职时间")]),t._v(" "),i("div",{staticClass:"form-group-inputbox-selectbox select-normal-40 left"},[i("el-date-picker",{staticClass:"header-right-time right",attrs:{type:"date",placeholder:"选择日期",editable:!1,clearable:!0,"value-format":"yyyy-MM-dd"},model:{value:t.dialogParam.entryTime,callback:function(e){t.$set(t.dialogParam,"entryTime",e)},expression:"dialogParam.entryTime"}})],1),t._v(" "),i("span",{staticClass:"form-group-inputbox-error"})])]),t._v(" "),i("div",{staticClass:"form-group-inputboxgroup"},[i("div",{staticClass:"form-group-inputbox"},[i("h2",{staticClass:"form-group-inputbox-title"},[i("span",{staticClass:"account-icon icon-required"}),t._v("邮箱")]),t._v(" "),i("div",{staticClass:"form-group-inputbox-selectbox select-normal-40 left"},[i("el-input",{staticClass:"header-right-time right",attrs:{placeholder:"请输入邮箱",clearable:!0},on:{change:t.checkEmail},model:{value:t.dialogParam.email,callback:function(e){t.$set(t.dialogParam,"email",e)},expression:"dialogParam.email"}})],1),t._v(" "),t.emailError?i("span",{staticClass:"form-group-inputbox-error"},[t._v(t._s(t.emailErrorMsg))]):t._e()])])])]),t._v(" "),i("div",{staticClass:"dialog_footer clear",attrs:{slot:"footer"},slot:"footer"},[i("button",{staticClass:"dialog-btn-submit btn-blue",class:{"btn-blue-disabled":!t.submitOk},on:{click:function(e){t.submitClick()}}},[t._v("确定")]),t._v(" "),i("button",{staticClass:"dialog-btn-submit btn-blue-border ",on:{click:t.dialogClose}},[t._v("取消")])])]),t._v(" "),i("el-dialog",{attrs:{title:"设置权限",visible:t.ruleDialog,width:"400px",center:"","append-to-body":!0,"before-close":t.ruleClose},on:{"update:visible":function(e){t.ruleDialog=e}}},[i("div",{staticClass:"dialog_content"},[i("el-tree",{ref:"tree",attrs:{"check-strictly":!0,data:t.ruleList,"show-checkbox":"","node-key":"id","default-checked-keys":t.defaultChechedArr,"default-expanded-keys":t.defaultChechedArr,props:t.defaultProps}})],1),t._v(" "),i("div",{staticClass:"dialog_footer clear",attrs:{slot:"footer"},slot:"footer"},[i("button",{staticClass:"dialog-btn-submit btn-blue",on:{click:t.commitRule}},[t._v("确定")]),t._v(" "),i("button",{staticClass:"dialog-btn-submit btn-blue-border ",on:{click:function(e){t.ruleDialog=!1}}},[t._v("取消")])])])],1)])},staticRenderFns:[]};var c=a("C7Lr")(r,n,!1,function(t){a("yw/z")},"data-v-733e519a",null);e.default=c.exports},"yw/z":function(t,e){}});
//# sourceMappingURL=95.292a458fe8dd0724b948.js.map