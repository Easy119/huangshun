webpackJsonp([138],{"860b":function(t,a,i){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var e=i("3cXf"),s=i.n(e),l=i("2hMI"),o=i("lKYg"),n=i("aiqZ"),r=i("yclV"),c={data:function(){return{busy:!0,nodata:!1,createDialogShow:!1,dialogTitle:"创建企业大事",totalCompanyList:[],companyList:[],loading:!1,titleList:[{name:"董事会"},{name:"股东会"},{name:"年报提交"}],dialogParam:{title:"",companyId:"",companyVal:"",addTime:"",warnTime:"",descrip:"",multiple:!1},oldDialogParam:"",createType:-1,number:10,page:1,search:"",recentData:[],datalist:[],total:0}},components:{progressBar:o.a,quillEditor:n.quillEditor},mounted:function(){},computed:{submitOk:function(){var t=this.dialogParam;return""!=t.title&&""!=t.companyId&&""!=t.addTime}},created:function(){this.initData()},methods:{initData:function(){var t=this;this.page=1,this.datalist=[],Object(l._13)().then(function(a){if(1==a.data.msgNo){var i=a.data.payload;i.forEach(function(t){0==t.status?t.checked=!1:t.checked=!0,t.time=t.addTime.split(" ")}),t.recentData=i,0==t.recentData.length?t.nodata=!0:t.nodata=!1}}),this.getCompanyEventlist()},getBigeventCompanyList:function(){var t=this;Object(l._12)().then(function(a){if(1==a.data.msgNo){t.totalCompanyList=a.data.payload;var i=a.data.payload.length;t.companyList=a.data.payload,t.dialogParam.multiple&&(t.companyList.unshift({id:-1,name:"全选"+i+"个项目",smallname:"（选择此时项目库中的所有项目）"}),t.companyList.unshift({id:0,name:"所有项目",smallname:"（选择此项包含后面的新添加项目也会自动创建此提醒）"}))}})},getCompanyEventlist:function(){var t=this;Object(l._10)({number:this.number,page:this.page,search:this.search}).then(function(a){1==a.data.msgNo&&(a.data.payload.data.forEach(function(t){""==t.logo&&(t.logo="../../static/images/company_headerimg_normal.png")}),t.datalist=t.datalist.concat(a.data.payload.data),t.total=a.data.payload.total)})},getImgurl:function(t){t.currentTarget.src="../../static/images/company_headerimg_normal.png",t.onerror=null},addSpan:function(){""!=this.currentspan&&(-1==this.commitData.spanlist.indexOf(this.currentspan)&&this.commitData.spanlist.push(this.currentspan),this.currentspan="")},deleteSpan:function(t){this.commitData.spanlist.splice(t,1)},addFile:function(t){},createEvent:function(t){if(this.createType=t,this.dialogParam={title:"",companyId:"",companyVal:"",addTime:"",warnTime:"",descrip:"",multiple:!0},this.createDialogShow=!0,-1==t)this.dialogTitle="创建新企业大事",this.dialogParam.companyId=[],this.dialogParam.companyVal=[];else{this.dialogTitle="编辑企业大事";var a=this.recentData[t];void 0==a.companyId&&(a.companyId=this.companyId),void 0==a.name&&(a.name=this.companyName),this.dialogParam={id:a.id,status:a.status,title:a.title,companyId:a.companyId,companyVal:a.name,addTime:a.addTime,warnTime:a.warnTime,descrip:a.descrip,multiple:!1}}this.getBigeventCompanyList(),this.oldDialogParam=JSON.parse(s()(this.dialogParam))},remoteMethod:function(t){var a=this;""!=t?(this.loading=!0,setTimeout(function(){a.loading=!1,a.companyList=a.totalCompanyList.filter(function(a){return a.name.indexOf(t)>-1})},200)):this.companyList=this.totalCompanyList},createEventCommit:function(){var t=this;this.submitOk?""!=this.dialogParam.warnTime&&Date.parse(this.dialogParam.warnTime)>Date.parse(this.dialogParam.addTime)?Object(r.g)("info","提醒时间不能大于结束时间"):(void 0==this.dialogParam.descrip&&(this.dialogParam.descrip=""),void 0==this.dialogParam.warnTime&&(this.dialogParam.warnTime=""),-1==this.createType?Object(l._303)({title:this.dialogParam.title,companyId:this.dialogParam.companyId.toString(),addTime:this.dialogParam.addTime,warnTime:this.dialogParam.warnTime,descrip:this.dialogParam.descrip}).then(function(a){1==a.data.msgNo?Object(r.g)("success","提交成功！"):Object(r.g)("fail","提交失败！"),t.initData(),t.createDialogShow=!1,t.dialogConfirm={title:"",companyId:"",companyVal:"",addTime:"",warnTime:"",descrip:""}}):Object(l._246)({id:this.dialogParam.id,title:this.dialogParam.title,companyId:this.dialogParam.companyId,addTime:this.dialogParam.addTime,warnTime:this.dialogParam.warnTime,descrip:this.dialogParam.descrip,status:this.dialogParam.status}).then(function(a){1==a.data.msgNo?Object(r.g)("success","修改成功"):Object(r.g)("fail","修改失败！"),t.initData(),t.createDialogShow=!1,t.dialogConfirm={title:"",companyId:"",companyVal:"",addTime:"",warnTime:"",descrip:""}})):Object(r.g)("info","您还有必填项没有填写")},loadMore:function(){this.datalist.length<this.total&&(this.page++,this.getCompanyEventlist())},changeStatus:function(t,a){a=a?1:0,Object(l._246)({id:t,status:a}).then(function(t){})},gotoDetail:function(t,a){this.$router.push({name:"investedCompanyEventloglist",query:{id:t,name:a}})},changeCompany:function(t){if(1==this.dialogParam.multiple){var a=[],i=t[t.length-1];if(-1==i)a=[-1];else if(0==i)a=[0];else for(var e in t)-1!=t[e]&&0!=t[e]&&a.push(t[e]);this.dialogParam.companyVal=a,this.dialogParam.companyId=a}},dialogClose:function(){var t=this;Object(r.e)(this.oldDialogParam,this.dialogParam)?(this.createDialogShow=!1,this.dialogParam={}):Object(r.h)("确认不保存就关闭吗？").then(function(a){t.createDialogShow=!1,t.dialogParam={}}).catch(function(){})}}},d={render:function(){var t=this,a=t.$createElement,i=t._self._c||a;return i("div",{staticClass:"personal-content-body"},[i("div",{staticClass:"content investPersonaInfoPublish scroll-style"},[t._m(0),t._v(" "),t.nodata?i("div",{staticClass:"content-body clear"},[i("div",{staticClass:"nodatabox"},[i("div",{staticClass:"nodata-title"},[t._v("被投企业大事记录")]),t._v(" "),i("div",{staticClass:"nodata-smalltitle"},[t._v("可以设置大事件的时间提醒，点评，投后管理点滴都可在此记")]),t._v(" "),i("div",{staticClass:"nodata-btn",on:{click:function(a){t.createEvent(-1)}}},[t._v("创建新企业大事")])])]):i("div",{staticClass:"content-body clear"},[i("div",{staticClass:"clear"},[i("div",{staticClass:"left breadcrumb"},[i("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[i("el-breadcrumb-item",{attrs:{to:{name:"investedCompanyEventlog"}}},[t._v("被投企业大事日志")])],1)],1)]),t._v(" "),i("div",{staticClass:"line"}),t._v(" "),i("div",{staticClass:"content-body-scroll"},[i("div",{staticClass:"eventlist-box"},[t._m(1),t._v(" "),i("div",{staticClass:"eventlist-list"},t._l(t.recentData,function(a,e){return i("div",{staticClass:"eventlist-item clear"},[i("div",{staticClass:"eventlist-item-left left"},[i("div",{staticClass:"eventlist-item-time"},[t._v("\n                  "+t._s(a.time[0])+"\n                  "),i("br"),t._v(" "+t._s(a.time[1])+"\n                ")]),t._v(" "),i("div",{staticClass:"eventlist-item-deadspan left"},[t._v(t._s(a.distance))])]),t._v(" "),i("div",{staticClass:"eventlist-item-right left"},[i("div",{staticClass:"eventlist-item-right-title clear"},[i("el-checkbox",{staticClass:"left",on:{change:function(i){t.changeStatus(a.id,a.checked)}},model:{value:a.checked,callback:function(i){t.$set(a,"checked",i)},expression:"item.checked"}}),t._v(" "),i("div",{staticClass:"eventlist-item-right-title-text left",class:{"eventlist-item-right-title-textline":a.checked}},[t._v(t._s(a.title))])],1),t._v(" "),i("div",{staticClass:"eventlist-item-right-company clear"},[a.checked?i("span",{staticClass:"invested-icon invested-icon-hide left"}):i("span",{staticClass:"invested-icon left",on:{click:function(a){t.createEvent(e)}}}),t._v(" "),i("div",{staticClass:"eventlist-item-right-title-text left"},[t._v(t._s(a.name))])]),t._v(" "),""!=a.descrip?i("div",{staticClass:"eventlist-item-right-content eventlist-item-right-title-text"},[t._v('"'+t._s(a.descrip)+'"\n                ')]):t._e()])])}))]),t._v(" "),i("div",{staticClass:"eventlist-box"},[i("div",{staticClass:"eventlist-title clear"},[i("span",{staticClass:"invested-icon icon-event"}),t._v(" "),i("em",{staticClass:"left"},[t._v("公司大事项")]),t._v(" "),i("div",{staticClass:"eventlist-title-btn",on:{click:function(a){t.createEvent(-1)}}},[i("span",{staticClass:"invested-icon"}),t._v("创建新企业大事")])]),t._v(" "),i("div",{staticClass:"eventlist-list"},t._l(t.datalist,function(a){return i("div",{staticClass:"eventlist-item1 clear"},[i("div",{staticClass:"eventlist-item1-left left"},[i("img",{staticClass:"eventlist-item1-left-img",attrs:{src:a.logo},on:{error:function(a){t.getImgurl(a)}}})]),t._v(" "),i("div",{staticClass:"eventlist-item1-right left"},[i("div",{staticClass:"eventlist-item1-right-company",on:{click:function(i){t.gotoDetail(a.id,a.name)}}},[t._v("\n                  "+t._s(a.name)+"\n                ")]),t._v(" "),i("div",{staticClass:"eventlist-item1-right-content clear"},[i("em",{staticClass:"left"},[t._v("最近事项")]),i("span",[t._v(t._s(a.count)+"条")])])])])}))]),t._v(" "),i("div",{directives:[{name:"infinite-scroll",rawName:"v-infinite-scroll",value:t.loadMore,expression:"loadMore"}],attrs:{"infinite-scroll-distance":"10"}})])]),t._v(" "),i("el-dialog",{attrs:{title:t.dialogTitle,visible:t.createDialogShow,width:"570px",center:"","append-to-body":!0,"before-close":t.dialogClose},on:{"update:visible":function(a){t.createDialogShow=a}}},[i("div",{staticClass:"dialog_content"},[i("div",{staticClass:"form-group margin-bottom-none"},[i("div",{staticClass:"form-group-inputboxgroup clear"},[i("div",{staticClass:"form-group-inputbox"},[i("h2",{staticClass:"form-group-inputbox-title"},[i("span",{staticClass:"account-icon icon-required"}),t._v("标题")]),t._v(" "),i("div",{staticClass:"form-group-inputbox-selectbox select-normal-40 left"},[i("el-select",{attrs:{filterable:"",clearable:"","reserve-keyword":"",placeholder:"可自己创建标题","allow-create":"",loading:t.loading},model:{value:t.dialogParam.title,callback:function(a){t.$set(t.dialogParam,"title",a)},expression:"dialogParam.title"}},t._l(t.titleList,function(a){return i("el-option",{key:a.name,attrs:{label:a.name,value:a.name}},[i("span",{},[t._v(t._s(a.name))])])}))],1),t._v(" "),i("span",{staticClass:"form-group-inputbox-error"})])]),t._v(" "),i("div",{staticClass:"form-group-inputboxgroup clear"},[i("div",{staticClass:"form-group-inputbox"},[i("h2",{staticClass:"form-group-inputbox-title"},[i("span",{staticClass:"account-icon icon-required"}),t._v("公司名称")]),t._v(" "),i("div",{staticClass:"form-group-inputbox-selectbox select-normal-40 left"},[i("el-select",{attrs:{filterable:"",multiple:t.dialogParam.multiple,clearable:"",remote:"","reserve-keyword":"",placeholder:"输入公司名搜索","remote-method":t.remoteMethod,loading:t.loading},on:{change:function(a){t.changeCompany(a)}},model:{value:t.dialogParam.companyVal,callback:function(a){t.$set(t.dialogParam,"companyVal",a)},expression:"dialogParam.companyVal"}},t._l(t.companyList,function(a){return i("el-option",{key:a.id,attrs:{label:a.name,value:a.id}},[i("span",{},[t._v(t._s(a.name))]),t._v(" "),i("span",{staticStyle:{color:"#8492a6","font-size":"13px"}},[t._v(t._s(a.smallname))])])}))],1),t._v(" "),i("span",{staticClass:"form-group-inputbox-error"})])]),t._v(" "),i("div",{staticClass:"form-group-inputboxgroup clear"},[i("div",{staticClass:"form-group-inputbox"},[i("h2",{staticClass:"form-group-inputbox-title"},[i("span",{staticClass:"account-icon icon-required"}),t._v("选择结束时间")]),t._v(" "),i("div",{staticClass:"form-group-inputbox-selectbox select-normal-40 left"},[i("el-date-picker",{staticClass:"header-right-time right",attrs:{type:"date",placeholder:"选择日期",editable:!1,clearable:!0,"value-format":"yyyy-MM-dd"},model:{value:t.dialogParam.addTime,callback:function(a){t.$set(t.dialogParam,"addTime",a)},expression:"dialogParam.addTime"}})],1),t._v(" "),i("span",{staticClass:"form-group-inputbox-error"})])]),t._v(" "),i("div",{staticClass:"form-group-inputboxgroup clear"},[i("div",{staticClass:"form-group-inputbox"},[i("h2",{staticClass:"form-group-inputbox-title"},[t._v("选择提醒时间"),i("em",{staticClass:"font-color-gray"},[t._v("(提醒时间不能大于结束时间)")])]),t._v(" "),i("div",{staticClass:"form-group-inputbox-selectbox select-normal-40 left"},[i("el-date-picker",{staticClass:"header-right-time right",attrs:{type:"date",placeholder:"选择日期",editable:!1,clearable:!0,"value-format":"yyyy-MM-dd"},model:{value:t.dialogParam.warnTime,callback:function(a){t.$set(t.dialogParam,"warnTime",a)},expression:"dialogParam.warnTime"}})],1),t._v(" "),i("span",{staticClass:"form-group-inputbox-error"})])]),t._v(" "),i("div",{staticClass:"form-group-inputboxgroup clear margin-bottom-none"},[i("div",{staticClass:"form-group-inputbox"},[i("h2",{staticClass:"form-group-inputbox-title"},[t._v("描述")]),t._v(" "),i("div",{staticClass:"form-group-inputbox-selectbox select-normal-40 left"},[i("textarea",{directives:[{name:"model",rawName:"v-model",value:t.dialogParam.descrip,expression:"dialogParam.descrip"}],staticClass:"textarea-normal",attrs:{name:""},domProps:{value:t.dialogParam.descrip},on:{input:function(a){a.target.composing||t.$set(t.dialogParam,"descrip",a.target.value)}}})])])])])]),t._v(" "),i("div",{staticClass:"dialog_footer clear",attrs:{slot:"footer"},slot:"footer"},[i("button",{staticClass:"dialog-btn-submit btn-blue",class:{"btn-blue-disabled":!t.submitOk},on:{click:t.createEventCommit}},[t._v("确认")]),t._v(" "),i("button",{staticClass:"dialog-btn-submit btn-blue-border",on:{click:t.dialogClose}},[t._v("取消")])])])],1)])},staticRenderFns:[function(){var t=this.$createElement,a=this._self._c||t;return a("div",{staticClass:"content-title clear"},[a("div",{staticClass:"left"},[this._v("被投企业大事日志")])])},function(){var t=this.$createElement,a=this._self._c||t;return a("div",{staticClass:"eventlist-title"},[a("span",{staticClass:"invested-icon"}),this._v("最近到期大事\n          ")])}]};var m=i("C7Lr")(c,d,!1,function(t){i("iwPL")},"data-v-4c0672d4",null);a.default=m.exports},iwPL:function(t,a){}});
//# sourceMappingURL=138.a6069fcae16211c21147.js.map