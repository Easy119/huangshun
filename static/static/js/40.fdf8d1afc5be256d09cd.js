webpackJsonp([40],{O8io:function(t,e){},hV6v:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=i("3cXf"),s=i.n(a),c=i("2hMI"),n=i("ksh9"),l=i("yclV"),d={data:function(){return{dataList:[],oldDatalist:[],joinVisibleDialog:!1,currentDate:"",week:0,weekText:"本周",editall:!1,selectedIdList:[],currentEditPeople:{name:"",pindex:0,index:0},newitem:{id:0,reasons:"",place:"",create_id:0,lv:0,attendee:[],participant:[]}}},components:{addPeopleModal:n.a},created:function(){var t=JSON.parse(Object(l.m)("htcx_userInfo")).is_admin;this.newitem.lv=t,this.getData()},computed:{},mounted:function(){},methods:{setEditall:function(t){this.editall=t,this.dataList.forEach(function(e){e.edit=t})},editClick:function(){this.setEditall(!0),this.oldDatalist=JSON.parse(s()(this.dataList))},saveClick:function(){var t=this;this.setEditall(!1),Object(c._242)({flag:2,data:this.dataList}).then(function(e){1==e.data.msgNo?(Object(l.g)("success","修改成功"),t.getData()):Object(l.g)("fail",e.data.message)})},cancelClick:function(){this.getData()},deleteItem:function(t,e){var i=this;Object(l.h)("确定要删除吗？").then(function(a){0!=i.dataList[t].child.leavecount?(i.dataList[t].child.leavecount=i.dataList[t].child.leavecount-1,i.dataList[t].child[e].hasdelete=!0,i.dataList[t].child[e].reasons="",i.dataList[t].child[e].place="",i.dataList[t].child[e].attendee=[],i.dataList[t].child[e].participant=[]):console.log(i.dataList[t].child.leavecount)}).catch(function(){})},addItem:function(t,e){var i=this.dataList[t].child[e];""===i.reasons&&""===i.place&&0==i.attendee.length&&i.participant.length;var a=JSON.parse(s()(this.newitem));this.dataList[t].child.splice(e+1,0,a),this.dataList[t].child.leavecount=this.dataList[t].child.leavecount+1},changeJoin:function(t,e,i){this.joinVisibleDialog=!0,this.currentEditPeople={name:t,pindex:e,index:i};var a=[];this.dataList[e].child[i][t].forEach(function(t){a.push(t.uid)}),this.selectedIdList=a},getFullModaldata:function(t,e){t.forEach(function(t){t.uid=t.id});var i=this.currentEditPeople.pindex,a=this.currentEditPeople.name,s=this.currentEditPeople.index;this.dataList[i].child[s][a]=t},getData:function(){var t=this;this.setEditall(!1),Object(c._242)({flag:1,offset:this.week}).then(function(e){if(1==e.data.msgNo){var i=e.data.payload;i.forEach(function(e){if(e.year=e.date.split("-")[0],e.date_str=e.date.split("-")[1]+"-"+e.date.split("-")[2],e.edit=!1,1==e.child.length&&0==e.child[0].id){for(var i in t.newitem)e.child[0][i]=t.newitem[i];e.haschild=!1,e.child.leavecount=0}else e.haschild=!0,e.child.leavecount=e.child.length}),t.dataList=i}})},changeDate:function(t){if(null!=t){var e=new Date(t),i=new Date(t),a=0==e.getDay()?7:e.getDay();e.setDate(e.getDate()-a+1),i.setDate(i.getDate()-a+1),i.setDate(i.getDate()+6);var s=e.Format("yyyy-MM-dd")+"~"+i.Format("yyyy-MM-dd"),c=e.getTime(),n=new Date,l=0==n.getDay()?7:n.getDay();n.setDate(n.getDate()-l+1);var d=n.getTime(),o=0;o=c>d?0==(o=parseInt((c-d)/1e3/60/60/24))?0:o+1:-0==(o=-parseInt((d-c)/1e3/60/60/24))?0:o,o/=7,this.changeWeek(o,s)}else this.changeWeek(0,"")},changeWeek:function(t,e){switch(this.week=t,this.week){case-1:this.weekText="上周";break;case 0:this.weekText="本周";break;case 1:this.weekText="下周";break;default:this.weekText=e}this.getData()},deletePeople:function(t,e){e.splice(t,1)},changeModalShow:function(t,e){this[e+"VisibleDialog"]=t},getModaldata:function(t,e){},getImgurl:function(t){t.currentTarget.src="../../static/images/header_userimg.png",t.onerror=null}}},o={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"personal-content-body"},[i("div",{staticClass:"table-content"},[i("div",{staticClass:"clear table-content-title"},[i("div",{staticClass:"right flex flex_center"},[i("div",{staticClass:"schedule_weekbtn",class:{current:-1==t.week},on:{click:function(e){t.changeWeek(-1,"")}}},[t._v("上周")]),t._v(" "),i("div",{staticClass:"schedule_weekbtn",class:{current:0==t.week},on:{click:function(e){t.changeWeek(0,"")}}},[t._v("本周")]),t._v(" "),i("div",{staticClass:"schedule_weekbtn",class:{current:1==t.week},on:{click:function(e){t.changeWeek(1,"")}}},[t._v("下周")]),t._v(" "),i("el-date-picker",{attrs:{size:"mini",placeholder:"选择日期",type:"date",editable:!1,"value-format":"timestamp"},on:{change:t.changeDate},model:{value:t.currentDate,callback:function(e){t.currentDate=e},expression:"currentDate"}}),t._v(" "),t.editall?t._e():i("div",{staticClass:"table-group-title-btn btn-blue",on:{click:t.editClick}},[t._v("编辑")]),t._v(" "),t.editall?i("div",{staticClass:"table-group-title-btn btn-blue",on:{click:t.saveClick}},[t._v("保存")]):t._e(),t._v(" "),t.editall?i("div",{staticClass:"schedule_icontextbtn",on:{click:t.cancelClick}},[t._v("取消")]):t._e()],1)]),t._v(" "),i("div",{staticClass:"table-group"},[i("div",{staticClass:"table-group-content"},[i("div",{staticClass:"schedule_box"},[i("div",{staticClass:"schedule_header",class:{schedule_header_sz:-1==t.week,schedule_header_xz:1==t.week,schedule_header_bz:0==t.week}},[t._v("\n\t\t\t\t\t\t"+t._s(t.weekText)+"\n\t\t\t\t\t")]),t._v(" "),t._l(t.dataList,function(e,a){return i("div",{staticClass:"schedule_group"},[i("div",{staticClass:"schedule_group_left"},[i("div",{staticClass:"schedule_group_left_left"},[i("div",{staticClass:"schedule_week"},[t._v(t._s(e.weekday))]),t._v(" "),i("div",{staticClass:"schedule_date"},[t._v(t._s(e.date_str))])]),t._v(" "),i("div",{staticClass:"schedule_group_left_right"},[e.edit?t._e():i("div",{staticClass:"schedule_icontextbtn",on:{click:function(t){e.edit=!0}}},[i("span",{staticClass:"iconfont icon-bianji"}),t._v("编辑\n\t\t\t\t\t\t\t\t")]),t._v(" "),e.edit&&!t.editall?i("div",{staticClass:"table-group-title-btn btn-blue",on:{click:t.saveClick}},[t._v("\n\t\t\t\t\t\t\t\t\t保存\n\t\t\t\t\t\t\t\t")]):t._e(),t._v(" "),e.edit&&!t.editall?i("div",{staticClass:"schedule_icontextbtn",on:{click:t.cancelClick}},[t._v("取消\n\t\t\t\t\t\t\t\t")]):t._e()])]),t._v(" "),i("div",{staticClass:"schedule_group_right"},[0!=e.haschild||e.edit?t._l(e.child,function(s,c){return i("div",{},[1!=s.hasdelete?i("div",{staticClass:"schedule_item"},[e.edit||""!=s.reasons?t._e():i("div",{staticClass:"schedule_notext"},[t._v("暂无事由信息")]),t._v(" "),e.edit||""==s.reasons?t._e():i("div",{staticClass:"schedule_content"},[t._v(t._s(s.reasons))]),t._v(" "),e.edit?i("textarea",{directives:[{name:"model",rawName:"v-model",value:s.reasons,expression:"child.reasons"}],staticClass:"schedule_content_textarea",attrs:{placeholder:"请输入事由..."},domProps:{value:s.reasons},on:{input:function(e){e.target.composing||t.$set(s,"reasons",e.target.value)}}}):t._e(),t._v(" "),i("div",{staticClass:"schedule_info"},[t._m(1,!0),t._v(" "),i("div",{staticClass:"schedule_info_right"},[i("div",{staticClass:"schedule_userlist"},[e.edit||0!=s.attendee.length?t._e():i("div",{staticClass:"schedule_notext"},[t._v("暂无出席人")]),t._v(" "),t._l(s.attendee,function(a,c){return i("div",{staticClass:"schedule_useritem"},[i("img",{attrs:{src:a.url},on:{error:t.getImgurl}}),t._v(" "),i("div",{staticClass:"schedule_username"},[t._v(t._s(a.name))]),t._v(" "),e.edit?i("span",{staticClass:"iconfont icon-delete-black",on:{click:function(e){t.deletePeople(c,s.attendee)}}}):t._e()])}),t._v(" "),i("div",{staticClass:"schedule_additem"},[e.edit?i("span",{staticClass:"iconfont icon-add",on:{click:function(e){t.changeJoin("attendee",a,c)}}}):t._e()])],2)])]),t._v(" "),i("div",{staticClass:"schedule_info"},[t._m(2,!0),t._v(" "),i("div",{staticClass:"schedule_info_right"},[i("div",{staticClass:"schedule_userlist"},[e.edit||0!=s.participant.length?t._e():i("div",{staticClass:"schedule_notext"},[t._v("暂无参加人")]),t._v(" "),t._l(s.participant,function(a,c){return i("div",{staticClass:"schedule_useritem"},[i("img",{attrs:{src:a.url},on:{error:t.getImgurl}}),t._v(" "),i("div",{staticClass:"schedule_username"},[t._v(t._s(a.name))]),t._v(" "),e.edit?i("span",{staticClass:"iconfont icon-delete-black",on:{click:function(e){t.deletePeople(c,s.participant)}}}):t._e()])}),t._v(" "),i("div",{staticClass:"schedule_additem"},[e.edit?i("span",{staticClass:"iconfont icon-add",on:{click:function(e){t.changeJoin("participant",a,c)}}}):t._e()])],2)])]),t._v(" "),i("div",{staticClass:"schedule_info"},[t._m(3,!0),t._v(" "),i("div",{staticClass:"schedule_info_right"},[e.edit||""==s.place?t._e():i("div",{staticClass:"schedule_address"},[t._v(t._s(s.place))]),t._v(" "),e.edit||""!=s.place?t._e():i("div",{staticClass:"schedule_address schedule_address_notext"},[t._v("暂无地址信息")]),t._v(" "),e.edit?i("input",{directives:[{name:"model",rawName:"v-model",value:s.place,expression:"child.place"}],staticClass:"schedule_content_input",attrs:{placeholder:"请输入地址..."},domProps:{value:s.place},on:{input:function(e){e.target.composing||t.$set(s,"place",e.target.value)}}}):t._e()])]),t._v(" "),i("div",{staticClass:"schedule_btnbox flex"},[e.edit&&0!=e.child.leavecount?i("div",{staticClass:"table-group-title-btn btn-blue-border",on:{click:function(e){t.deleteItem(a,c)}}},[i("span",{staticClass:"iconfont icon-shanchu"}),t._v("删除\n\t\t\t\t\t\t\t\t\t\t")]):t._e(),t._v(" "),e.edit?i("div",{staticClass:"table-group-title-btn btn-blue",on:{click:function(e){t.addItem(a,c)}}},[i("span",{staticClass:"iconfont icon-jia"}),t._v("添加\n\t\t\t\t\t\t\t\t\t\t")]):t._e()])]):t._e()])}):i("div",{staticClass:"schedule_item"},[t._m(0,!0)])],2)])})],2)])])]),t._v(" "),i("add-people-modal",{attrs:{visibleDialog:t.joinVisibleDialog,name:"join",selectedId:t.selectedIdList,title:"选择默认抄送人"},on:{changeshow:t.changeModalShow,setData:t.getModaldata,getData:t.getFullModaldata}})],1)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"schedule_nodata"},[e("img",{attrs:{src:i("iiGF")}}),this._v(" "),e("div",[this._v("暂无工作安排")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"schedule_info_left"},[e("span",{staticClass:"iconfont icon-lianxiren"}),this._v("出席人\n\t\t\t\t\t\t\t\t\t\t")])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"schedule_info_left"},[e("span",{staticClass:"iconfont icon-lianxiren"}),this._v("参加人\n\t\t\t\t\t\t\t\t\t\t")])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"schedule_info_left"},[e("span",{staticClass:"iconfont icon-dingwei"}),this._v("地址\n\t\t\t\t\t\t\t\t\t\t")])}]};var r=i("C7Lr")(d,o,!1,function(t){i("O8io")},"data-v-24e1de48",null);e.default=r.exports},iiGF:function(t,e,i){t.exports=i.p+"static/img/weeklySchedule_nodata.5b9f5a0.png"}});
//# sourceMappingURL=40.fdf8d1afc5be256d09cd.js.map