webpackJsonp([149],{"9MEO":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=r("2hMI"),a=r("yclV"),i={data:function(){return{fundId:"",fundName:"",peoplelist:[],projectManagerId:"",otheruser:[],filterText:"",defaultChechedArr:[],defaultProps:{children:"children",label:"name"},number:0,page:1}},created:function(){this.fundId=this.$route.query.id,this.fundName=decodeURIComponent(this.$route.query.name),this.getProjectPowerInfo(),this.$route.query.page&&(this.page=this.$route.query.page)},watch:{filterText:function(e){this.$refs.tree.filter(e)},projectManagerId:function(e,t){var r=this;if(""!=e&&void 0!=e&&null!=e)if(this.peoplelist.forEach(function(s){s.id==e||void 0!=s.children&&s.children.forEach(function(s){s.id==e?(r.$refs.tree.setChecked(e,!0),r.$refs.tree.setChecked(e,!1),s.disabled=!0):(s.disabled=!1,s.id==t&&(r.$refs.tree.setChecked(t,!0),r.$refs.tree.setChecked(t,!1)))})}),0==this.number)this.number=1;else{var s=[];this.$refs.tree.getCheckedNodes().forEach(function(e){var t={};t.user_id=e.id,t.name=e.name,s.push(t)}),s=s.sort(this.compare("user_id")),this.otheruser=s}}},computed:{},methods:{getProjectPowerInfo:function(){var e=this;Object(s._173)({fund_id:this.fundId}).then(function(t){if(1==t.data.msgNo){var r=t.data.payload;e.peoplelist=r.depart,r.depart.forEach(function(e,t){void 0!=e.children&&0!=e.children.length||r.depart.splice(t,1)}),e.projectManagerId=r.manager.user_id,r.otheruser=r.otheruser.sort(e.compare("user_id")),e.otheruser=r.otheruser,e.otheruser.forEach(function(t){e.defaultChechedArr.push(t.user_id)})}})},filterNode:function(e,t){return!e||-1!==t.name.indexOf(e)},checkMethod:function(e,t){var r=[];t.checkedNodes.forEach(function(e){if(void 0==e.children){var t={};t.user_id=e.id,t.name=e.name,r.push(t)}}),r=r.sort(this.compare("user_id")),this.otheruser=r},deleteUser:function(e){var t=this;this.otheruser.forEach(function(r,s){e==r.user_id&&t.otheruser.splice(s,1)});var r=[];this.otheruser.forEach(function(e,t){r.push(e.user_id)}),this.$refs.tree.setCheckedKeys(r)},toSetComManagerAndUser:function(){var e=this,t=[];if(this.otheruser.forEach(function(e){t.push(e.user_id)}),void 0==this.projectManagerId||""==this.projectManagerId)return Object(a.g)("info","请选择投资经理"),!1;Object(s._321)({fund_id:this.fundId,manager_id:this.projectManagerId,user_id:t.join(",")}).then(function(t){1==t.data.msgNo?(Object(a.g)("success","基金管理人分配成功"),e.$router.push({name:"fundPermissions",query:{page:e.page}})):Object(a.g)("info",t.data.message)})},compare:function(e){return function(t,r){return t[e]-r[e]}}}},n={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"personal-content-body"},[r("div",{staticClass:"content creditQueryAdd"},[e._m(0),e._v(" "),r("div",{staticClass:"account-group"},[r("div",{staticClass:"left breadcrumb"},[r("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[r("el-breadcrumb-item",{attrs:{to:{name:"administrativeManageHomepageNew"}}},[e._v("行政管理")]),e._v(" "),r("el-breadcrumb-item",{attrs:{to:{path:"/home/fundPermissions?page="+e.page}}},[e._v("基金权限")]),e._v(" "),r("el-breadcrumb-item",[e._v(e._s(e.fundName))])],1)],1),e._v(" "),r("div",{staticClass:"line"}),e._v(" "),r("div",{staticClass:"company-name"},[e._v(e._s(e.fundName))]),e._v(" "),r("div",{staticClass:"step1-box"},[r("div",{staticClass:"step-title step1-title"},[e._v("基金经理设置")]),e._v(" "),r("div",{staticClass:"step1-select-box investPersonaInfoPublish"},[r("el-select",{staticClass:" header-right-time",attrs:{filterable:"",placeholder:"请选择一位人员成为投资经理"},model:{value:e.projectManagerId,callback:function(t){e.projectManagerId=t},expression:"projectManagerId"}},e._l(e.peoplelist,function(t){return r("el-option-group",{key:t.name,attrs:{label:t.name}},e._l(t.children,function(e){return r("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}))}))],1)]),e._v(" "),r("div",{staticClass:"projectTransfer-left-top clear"},[r("div",{staticClass:"projectTransfer-left-left left"},[r("div",{staticClass:"projectTransfer-left-left-title"},[e._v("其他拥有本基金权限的人员设置")]),e._v(" "),r("div",{staticClass:"select-tree"},[r("div",{staticClass:"search-inputbox"},[r("el-input",{staticClass:"header-right-time",attrs:{placeholder:"输入人名可进行搜索",clearable:!0},model:{value:e.filterText,callback:function(t){e.filterText=t},expression:"filterText"}},[r("i",{staticClass:"el-input__icon el-icon-search ",attrs:{slot:"prefix"},slot:"prefix"})])],1),e._v(" "),r("div",{staticClass:"projectTransfer-left-left-treetitle"},[e._v("部门")]),e._v(" "),r("div",{staticClass:"el-tree-box"},[r("el-tree",{ref:"tree",staticClass:"manegerTrees",attrs:{data:e.peoplelist,"show-checkbox":"","node-key":"id","default-checked-keys":e.defaultChechedArr,"default-expanded-keys":e.defaultChechedArr,props:e.defaultProps,"filter-node-method":e.filterNode},on:{check:e.checkMethod}})],1)])]),e._v(" "),r("div",{staticClass:"projectTransfer-left-right left"},[r("div",{staticClass:"projectTransfer-left-right-content-title"},[e._v("已选（"+e._s(e.otheruser.length)+"）")]),e._v(" "),r("div",{staticClass:"selected-project-list"},e._l(e.otheruser,function(t,s){return r("div",{key:s,staticClass:"selected-project-item"},[r("span",{staticClass:"icon-close",on:{click:function(r){e.deleteUser(t.user_id)}}}),e._v(" "+e._s(t.name)+"\n            ")])}))])]),e._v(" "),r("div",{staticClass:"projectTransfer-left-bottom-btnbox clear"},[r("div",{staticClass:"save-vicarious-btn btn-blue left",on:{click:e.toSetComManagerAndUser}},[e._v("提交")])])])])])},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"content-title clear"},[t("div",{staticClass:"left"},[this._v("基金权限")])])}]};var c=r("C7Lr")(i,n,!1,function(e){r("kdd7")},"data-v-406da10a",null);t.default=c.exports},kdd7:function(e,t){}});
//# sourceMappingURL=149.93b4c624c4b207c94030.js.map