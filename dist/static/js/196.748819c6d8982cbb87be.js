webpackJsonp([196],{"+5Hn":function(t,e){},wMpy:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=i("yclV"),s=i("2hMI"),n={name:"organizationStructure",data:function(){return{dialogTitle:"添加部门",dialogVisible:!1,departmentName:"",companyData:[],defaultProps:{children:"children",label:"name"},isAllCheck:!1,selectedNodes:[],depart_id:0,pid:0,dialogType:0}},created:function(){this.getData()},methods:{getData:function(){var t=this;Object(s._149)({type:2}).then(function(e){console.log(e),1==e.data.msgNo?t.companyData=t.addUnionId(e.data.payload):Object(a.g)("info",e.data.message)})},rename:function(t){this.departmentName=t.name,this.dialogTitle="重命名",this.dialogType=1,this.depart_id=t.id,this.pid=t.pid,this.dialogVisible=!0},remove:function(t,e){e.is_user?this.multiDeleteUser(e.id):this.toDeleteDepartment(e.id)},addDepartment:function(t,e){this.dialogType=2;1==t?(this.dialogTitle="新建部门",this.pid=0):(this.dialogTitle="添加子部门",this.pid=e.id),this.dialogVisible=!0},toAddDepartment:function(){var t=this;if(this.dialogType)if(1==this.dialogType)var e={depart_id:this.depart_id,depart_name:this.departmentName,pid:this.pid};else e={depart_name:this.departmentName,pid:this.pid};Object(s.l)(e).then(function(e){1==e.data.msgNo?(t.dialogVisible=!1,Object(a.g)("success","操作成功"),t.getData()):(t.dialogVisible=!1,Object(a.g)("info",e.data.message)),t.departmentName=""})},toDeleteDepartment:function(t){var e=this;Object(a.h)("确认删除该部门？").then(function(){Object(s._51)({depart_id:t}).then(function(t){1==t.data.msgNo?(Object(a.g)("success","删除成功"),e.getData()):Object(a.g)("fail","删除失败")})}).catch(function(){})},multiDeleteUser:function(t){var e=this,i=[];if(t)i.push(t);else i=this.$refs.tree.getCheckedKeys();var n=this.decodeSelectedUserId(i);Object(a.h)("确定要删除所选员工吗").then(function(){Object(s._62)({user_ids:n}).then(function(t){1==t.data.msgNo?(Object(a.g)("success","删除成功"),e.getData()):Object(a.g)("fail","删除失败")})}).catch(function(){})},cancel:function(){this.dialogVisible=!1,this.departmentName=""},allSelect:function(){this.isAllCheck?(this.getAllEmployeeData(this.companyData),this.$refs.tree.setCheckedNodes(this.selectedNodes)):this.$refs.tree.setCheckedNodes([])},getAllEmployeeData:function(t){for(var e in t)t[e].children?this.getAllEmployeeData(t[e].children):t[e].is_user&&this.selectedNodes.push(t[e])},addUnionId:function(t){for(var e in t)t[e].children?(this.$set(t[e],"disabled",!0),this.addUnionId(t[e].children)):t[e].is_user?t[e].id=t[e].id+"-"+t[e].one_department_id:this.$set(t[e],"disabled",!0);return t},decodeSelectedUserId:function(t){for(var e=[],i=[],a=0,s=t.length;a<s;a++)i=t[a].split("-"),e.push(i[0]);return e.join(",")}}},l={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"personal-content-body"},[i("div",{staticClass:"table-content-right"},[i("div",{staticClass:"table-group"},[i("div",{staticClass:"table-group-content"},[i("div",{staticClass:"clear table-group-title"},[i("div",{staticClass:"right flex_end"},[i("div",{staticClass:"table_group_title_delete cursor",on:{click:function(e){t.multiDeleteUser(0)}}},[t._v("\n\t\t\t\t\t\t\t删除\n\t\t\t\t\t\t")]),t._v(" "),i("div",{staticClass:"table-group-title-btn btn-blue",on:{click:function(e){t.addDepartment(1)}}},[i("span",{staticClass:"iconfont icon-jia"}),t._v("添加新部门\n\t\t\t\t\t\t")])])]),t._v(" "),i("div",{staticClass:"tree_table_box"},[i("div",{staticClass:"tree_table"},[i("div",{staticClass:"tree_header flex_between"},[i("div",{staticClass:"tree_header_left"},[i("input",{directives:[{name:"model",rawName:"v-model",value:t.isAllCheck,expression:"isAllCheck"}],attrs:{type:"checkbox",name:"",id:"",value:""},domProps:{checked:Array.isArray(t.isAllCheck)?t._i(t.isAllCheck,"")>-1:t.isAllCheck},on:{change:[function(e){var i=t.isAllCheck,a=e.target,s=!!a.checked;if(Array.isArray(i)){var n=t._i(i,"");a.checked?n<0&&(t.isAllCheck=i.concat([""])):n>-1&&(t.isAllCheck=i.slice(0,n).concat(i.slice(n+1)))}else t.isAllCheck=s},t.allSelect]}}),t._v(" "),i("span",[t._v("全选")])]),t._v(" "),t._m(0)]),t._v(" "),i("el-tree",{ref:"tree",attrs:{"default-expand-all":"","check-strictly":"",props:t.defaultProps,data:t.companyData,"show-checkbox":"","node-key":"id","expand-on-click-node":!0},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.node,s=e.data;return i("span",{staticClass:"custom-tree-node flex_between"},[i("span",[t._v(t._s(a.label))]),t._v(" "),i("span",{staticClass:"flex_end"},[a.data.is_user||"待分配"==a.data.name?i("div",{},[i("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(t){t.stopPropagation()}}},[t._v(" -- ")])],1):i("div",{},[i("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(e){e.stopPropagation(),t.addDepartment(2,s)}}},[t._v(" 添加 ")])],1),t._v(" "),a.data.is_user||"待分配"==a.data.name?i("div",{},[i("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(t){t.stopPropagation()}}},[t._v(" -- ")])],1):i("div",{},[i("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(e){e.stopPropagation(),t.rename(s)}}},[t._v(" 重命名 ")])],1),t._v(" "),"待分配"==a.data.name||"待分配"==a.parent.data.name?i("div",{},[i("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(t){t.stopPropagation()}}},[t._v(" -- ")])],1):i("div",{},[i("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(e){e.stopPropagation(),t.remove(a,s)}}},[t._v(" 删除 ")])],1)])])}}])})],1)])])])]),t._v(" "),i("el-dialog",{attrs:{"custom-class":"pop","append-to-body":"",title:t.dialogTitle,visible:t.dialogVisible,width:"400px",center:""},on:{"update:visible":function(e){t.dialogVisible=e}}},[i("div",{staticClass:"dialog_body"},[i("div",{staticClass:"pop_input_text"},[t._v("\n\t\t\t\t部门名称\n\t\t\t")]),t._v(" "),i("div",{staticClass:"pop_input_box"},[i("el-input",{attrs:{placeholder:"请输入部门名称",clearable:""},model:{value:t.departmentName,callback:function(e){t.departmentName=e},expression:"departmentName"}})],1)]),t._v(" "),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:t.cancel}},[t._v("取 消")]),t._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:t.toAddDepartment}},[t._v("确 定")])],1)])],1)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"tree_header_right flex_end"},[e("div",[this._v(" 添加子部门 ")]),this._v(" "),e("div",[this._v(" 重命名 ")]),this._v(" "),e("div",[this._v(" 删除 ")])])}]};var o=i("C7Lr")(n,l,!1,function(t){i("+5Hn")},"data-v-17adf476",null);e.default=o.exports}});
//# sourceMappingURL=196.748819c6d8982cbb87be.js.map