webpackJsonp([184],{"6nAZ":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var l=a("3cXf"),i=a.n(l),n=a("yclV"),s=a("2hMI"),o={inject:["reload"],data:function(){return{id:"",rate:1,type:1,count:"",is_log_editable:!1,is_total_editable:!1,currentIndex:-1,total_selected_money:0,total_selected_money_edit:0,total_selected:[],total_selected_edit:[],relate_table_data:[],total_table_data:[],detail_table_data:[]}},created:function(){this.id=this.$route.query.id,this.count=this.$route.query.count,this.type=this.$route.query.type,this.getInitData()},computed:{},mounted:function(){},methods:{editLog:function(){this.is_log_editable=!0,this.getEditLogData()},editTotal:function(){this.is_total_editable=!0},editDetail:function(t){this.currentIndex=t.id},editCancel:function(){this.reload()},getInitData:function(){var t=this;Object(s._180)({count:this.count,difference_sign:this.type}).then(function(e){1==e.data.msgNo?(t.relate_table_data=e.data.payload.event_logs,t.total_table_data=e.data.payload.event,t.detail_table_data=e.data.payload.detail,t.handleSelectionChange(t.relate_table_data)):Object(n.g)("info",e.data.message)})},editSaveTotal:function(t){var e=this;Object(s._108)({count:this.count,event:t.event,plan_receive_date:t.plan_receive_date,scale:t.scale,fof_id:this.id,id:t.id,difference_sign:this.type,event_count:t.event_count}).then(function(t){1==t.data.msgNo?(Object(n.g)("success",t.data.message),e.is_total_editable=!1,e.getInitData()):Object(n.g)("info",t.data.message)})},editSaveDetail:function(t){var e=this;t.difference_sign=this.type,t.receive_date?Object(s._102)(t).then(function(t){1==t.data.msgNo?(Object(n.g)("success",t.data.message),e.currentIndex=-1,e.getInitData()):Object(n.g)("info",t.data.message)}):Object(n.g)("info","实际到账日期不可为空")},getEditLogData:function(){var t=this;Object(s._168)({id:this.total_table_data[0].id,difference_sign:this.type}).then(function(e){1==e.data.msgNo?t.relate_table_data=e.data.payload.event:Object(n.g)("info",e.data.message)})},editSaveLog:function(){var t=this,e=this.total_table_data[0].id;this.total_selected_edit.forEach(function(t){t.event_id=e,t.payback_fof_id=t.id});var a=i()(this.total_selected_edit);Object(s._104)({count:this.count,event_log:a,difference_sign:this.type}).then(function(e){1==e.data.msgNo?(Object(n.g)("success",e.data.message),t.reload()):Object(n.g)("info",e.data.message)})},handleSelectionChange:function(t){for(var e=0,a=0,l=t.length;a<l;a++)2==t.unit?e+=Number(t[a].rest_fee)*rate:e+=Number(t[a].rest_fee);e=e.toFixed(6),e=Object(n.j)(e),this.is_log_editable?(this.total_selected_edit=t,this.total_selected_money_edit=e):(this.total_selected=t,this.total_selected_money=e)},view:function(t){if(1==this.type)var e="motherFunRunDataCashFlowBackMoney";else e="selfAdministerFunRunDataCashFlowBackMoney";this.$router.push({name:e,query:{id:this.id,type:this.type,count:t.id}})},calculate:function(t){parseFloat(this.detail_table_data[t].subscribe)<parseFloat(this.detail_table_data[t].principal_distribution)&&(Object(n.g)("info","分配本金应小于或等于实缴出资!"),this.detail_table_data[t].principal_distribution=0),this.detail_table_data[t].this_sum_distribution=Number(this.detail_table_data[t].principal_distribution)+Number(this.detail_table_data[t].final_income),this.detail_table_data[t].sum_distribution=Number(this.detail_table_data[t].this_sum_distribution)+Number(this.detail_table_data[t].last_sum_distribution)},chooseDate:function(t){if(!t)return this.total_table_data[0].event="",void(this.total_table_data[0].event_count="");this.getEventCountData()},getEventCountData:function(){var t=this;if(1==this.type)var e=2;else e=3;var a=this.total_table_data[0].plan_receive_date,l=this.total_table_data[0].id;Object(s._169)({type:e,id:this.id,cash_type:4,date:a,fund_type:"",fund_id:"",event_id:l}).then(function(e){1==e.data.msgNo?(t.total_table_data[0].event=e.data.payload.event_name,t.total_table_data[0].event_count=e.data.payload.event_count):Object(n.g)("info",e.data.message)})},getRate:function(){var t=this;Object(s._211)({}).then(function(e){console.log(e),1==e.data.msgNo?t.rate=e.data.payload.exchangeRate:Object(n.g)("info",e.data.message)})}}},r={render:function(){var t=this,e=t.$createElement,l=t._self._c||e;return l("div",{staticClass:"body"},[l("div",{staticClass:"cash_flow_table_box"},[t._m(0),t._v(" "),l("div",{staticClass:"relete_back_title flex_between"},[t.is_log_editable?l("div",{},[t._v("\n\t\t\t\t\t本次已选择待分配总额"),l("span",[t._v(t._s(t.total_selected_money_edit)+"万元")])]):l("div",{},[t._v("\n\t\t\t\t\t本次已选择待分配总额"),l("span",[t._v(t._s(t.total_selected_money)+"万元")])]),t._v(" "),t.is_log_editable?l("div",{staticClass:"flex_end cursor"},[l("div",{staticClass:"hover_btn cursor",on:{click:t.editCancel}},[t._v("\n\t\t\t\t\t\t取消\n\t\t\t\t\t")]),t._v(" "),l("div",{staticClass:"blue_btn cursor",on:{click:t.editSaveLog}},[t._v("\n\t\t\t\t\t\t确定\n\t\t\t\t\t")])]):l("div",{staticClass:"blue_btn cursor",on:{click:t.editLog}},[t._v("\n\t\t\t\t\t修改\n\t\t\t\t")])]),t._v(" "),l("div",{staticClass:"cash_flow_table"},[l("div",{staticClass:"under_fund_main table"},[l("el-table",{ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:t.relate_table_data,border:""},on:{"selection-change":t.handleSelectionChange}},[t.is_log_editable?l("el-table-column",{attrs:{type:"selection",width:"55"}}):t._e(),t._v(" "),l("el-table-column",{attrs:{prop:"event",label:"序号",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n\t\t\t\t\t\t\t\t"+t._s(e.$index+1)+"\n\t\t\t\t\t\t\t")]}}])}),t._v(" "),l("el-table-column",{attrs:{prop:"receive_date",label:"到账日期",width:"180"}}),t._v(" "),l("el-table-column",{attrs:{prop:"event",label:"事件名称",width:"180"}}),t._v(" "),l("el-table-column",{attrs:{prop:"fund_name",label:"标的名称",width:"180"}}),t._v(" "),l("el-table-column",{attrs:{prop:"payback_type_name",label:"回款类型",width:"180"}}),t._v(" "),l("el-table-column",{attrs:{prop:"sum_back",label:"回款返本（万元）",width:"180"}}),t._v(" "),l("el-table-column",{attrs:{prop:"sum_profile",label:"回款收益-税后（万元）",width:"200"}}),t._v(" "),l("el-table-column",{attrs:{prop:"sum_calculate",label:"回款总额（万元）",width:"180"}}),t._v(" "),l("el-table-column",{attrs:{prop:"rest_fee",label:"待分配余额（万元）",width:"180"}}),t._v(" "),l("el-table-column",{attrs:{fixed:"right",label:"操作",width:"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[l("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){t.view(e.row)}}},[t._v("查看")])]}}])}),t._v(" "),l("template",{slot:"empty"},[l("div",{staticClass:"table-nodata"},[l("img",{attrs:{src:a("urJZ")}}),t._v(" 没有对应数据\n\t\t\t\t\t\t\t")])])],2)],1)])]),t._v(" "),l("div",{staticClass:"cash_flow_table_box"},[t._m(1),t._v(" "),l("div",{staticClass:"cash_flow_table"},[l("div",{staticClass:"under_fund_main table"},[l("el-table",{ref:"",staticStyle:{width:"100%"},attrs:{data:t.total_table_data,border:""}},[l("el-table-column",{attrs:{prop:"plan_receive_date",label:"计划到账日期",width:"200"},scopedSlots:t._u([{key:"default",fn:function(e){return[t.is_total_editable?l("div",{},[l("el-date-picker",{attrs:{editable:!1,type:"date","value-format":"yyyy-MM-dd",placeholder:"选择日期"},on:{change:function(e){t.chooseDate(e)}},model:{value:e.row.plan_receive_date,callback:function(a){t.$set(e.row,"plan_receive_date",a)},expression:"scope.row.plan_receive_date"}})],1):l("div",{},[t._v("\n\t\t\t\t\t\t\t\t\t"+t._s(e.row.plan_receive_date)+"\n\t\t\t\t\t\t\t\t")])]}}])}),t._v(" "),l("el-table-column",{attrs:{prop:"event",label:"事件",width:"200"}}),t._v(" "),l("el-table-column",{attrs:{prop:"scale",label:"本金占比",width:"200"},scopedSlots:t._u([{key:"default",fn:function(e){return[t.is_total_editable?l("div",{staticClass:"flex_between"},[l("el-input",{attrs:{placeholder:"本金占比",clearable:""},model:{value:e.row.scale,callback:function(a){t.$set(e.row,"scale",a)},expression:"scope.row.scale"}}),t._v("\n\t\t\t\t\t\t\t\t\t%\n\t\t\t\t\t\t\t\t")],1):l("div",{},[t._v("\n\t\t\t\t\t\t\t\t\t"+t._s(e.row.scale)+" %\n\t\t\t\t\t\t\t\t")])]}}])}),t._v(" "),l("el-table-column",{attrs:{prop:"sum_distribution",label:"分配本金（万元）",width:"200"}}),t._v(" "),l("el-table-column",{attrs:{prop:"sum_distribution_before_tax",label:"分配收益-税前（万元）",width:"200"}}),t._v(" "),l("el-table-column",{attrs:{prop:"distributions",label:"分配总额（万元）",width:"200"}}),t._v(" "),l("el-table-column",{attrs:{prop:"unit",label:"币种",width:"200"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n\t\t\t\t\t\t\t\t"+t._s(1==e.row.unit?"人民币":"美元")+"\n\t\t\t\t\t\t\t")]}}])}),t._v(" "),l("el-table-column",{attrs:{fixed:"right",label:"操作",width:"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[t.is_total_editable?l("div",{},[l("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){t.editSaveTotal(e.row)}}},[t._v("保存")]),t._v(" "),l("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){t.editCancel(e.row)}}},[t._v("取消")])],1):l("div",{},[l("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){t.editTotal(e.row)}}},[t._v("编辑")])],1)]}}])}),t._v(" "),l("template",{slot:"empty"},[l("div",{staticClass:"table-nodata"},[l("img",{attrs:{src:a("urJZ")}}),t._v(" 没有对应数据\n\t\t\t\t\t\t\t")])])],2)],1)])]),t._v(" "),l("div",{staticClass:"cash_flow_table_box"},[t._m(2),t._v(" "),l("div",{staticClass:"cash_flow_table"},[l("div",{staticClass:"under_fund_main table"},[l("el-table",{ref:"",staticStyle:{width:"100%"},attrs:{data:t.detail_table_data,border:""}},[l("el-table-column",{attrs:{prop:"event",label:"序号",width:"100",sortable:""},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n\t\t\t\t\t\t\t\t"+t._s(e.$index+1)+"\n\t\t\t\t\t\t\t")]}}])}),t._v(" "),l("el-table-column",{attrs:{prop:"investor_name",label:"合伙人名称",width:"200",sortable:""}}),t._v(" "),l("el-table-column",{attrs:{prop:"subscribe",label:"实缴出资（万元）",width:"200",sortable:""}}),t._v(" "),l("el-table-column",{attrs:{prop:"subscribe_scale",label:"实缴占比（%）",width:"200",sortable:""},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n\t\t\t\t\t\t\t\t"+t._s(e.row.subscribe_scale)+" %\n\t\t\t\t\t\t\t")]}}])}),t._v(" "),l("el-table-column",{attrs:{prop:"receive_date",label:"实际到账日期",width:"200",sortable:""},scopedSlots:t._u([{key:"default",fn:function(e){return[t.currentIndex!=e.row.id?l("div",{},[t._v("\n\t\t\t\t\t\t\t\t\t"+t._s(e.row.receive_date)+"\n\t\t\t\t\t\t\t\t")]):l("div",{},[l("el-date-picker",{attrs:{type:"date",editable:!1,"value-format":"yyyy-MM-dd",placeholder:"选择日期"},model:{value:e.row.receive_date,callback:function(a){t.$set(e.row,"receive_date",a)},expression:"scope.row.receive_date"}})],1)]}}])}),t._v(" "),l("el-table-column",{attrs:{prop:"principal_distribution",label:"本金分配（万元）",width:"200",sortable:""},scopedSlots:t._u([{key:"default",fn:function(e){return[t.currentIndex!=e.row.id?l("div",{},[t._v("\n\t\t\t\t\t\t\t\t\t"+t._s(e.row.principal_distribution)+"\n\t\t\t\t\t\t\t\t")]):l("div",{},[l("el-input",{attrs:{placeholder:"请输入",clearable:""},on:{input:function(a){t.calculate(e.$index)}},model:{value:e.row.principal_distribution,callback:function(a){t.$set(e.row,"principal_distribution",t._n(a))},expression:"scope.row.principal_distribution"}})],1)]}}])}),t._v(" "),l("el-table-column",{attrs:{prop:"income_before_tax",label:"收益分配-税前（万元）",width:"200",sortable:""},scopedSlots:t._u([{key:"default",fn:function(e){return[t.currentIndex!=e.row.id?l("div",{},[t._v("\n\t\t\t\t\t\t\t\t\t"+t._s(e.row.income_before_tax)+"\n\t\t\t\t\t\t\t\t")]):l("div",{},[l("el-input",{attrs:{placeholder:"",clearable:""},model:{value:e.row.income_before_tax,callback:function(a){t.$set(e.row,"income_before_tax",t._n(a))},expression:"scope.row.income_before_tax"}})],1)]}}])}),t._v(" "),l("el-table-column",{attrs:{prop:"interest",label:"应付利息/利息收入（万元）",width:"230",sortable:""},scopedSlots:t._u([{key:"default",fn:function(e){return[t.currentIndex!=e.row.id?l("div",{},[t._v("\n\t\t\t\t\t\t\t\t\t"+t._s(e.row.interest)+"\n\t\t\t\t\t\t\t\t")]):l("div",{},[l("el-input",{attrs:{placeholder:"",clearable:""},model:{value:e.row.interest,callback:function(a){t.$set(e.row,"interest",a)},expression:"scope.row.interest"}})],1)]}}])}),t._v(" "),l("el-table-column",{attrs:{prop:"income_after_interest",label:"息后收益分配-税前（万元）",width:"230",sortable:""},scopedSlots:t._u([{key:"default",fn:function(e){return[t.currentIndex!=e.row.id?l("div",{},[t._v("\n\t\t\t\t\t\t\t\t\t"+t._s(e.row.income_after_interest)+"\n\t\t\t\t\t\t\t\t")]):l("div",{},[l("el-input",{attrs:{placeholder:"",clearable:""},model:{value:e.row.income_after_interest,callback:function(a){t.$set(e.row,"income_after_interest",a)},expression:"scope.row.income_after_interest"}})],1)]}}])}),t._v(" "),l("el-table-column",{attrs:{prop:"service_fee",label:"代扣代缴（20%）",width:"200",sortable:""},scopedSlots:t._u([{key:"default",fn:function(e){return[t.currentIndex!=e.row.id?l("div",{},[t._v("\n\t\t\t\t\t\t\t\t\t"+t._s(e.row.service_fee)+"\n\t\t\t\t\t\t\t\t")]):l("div",{},[l("el-input",{attrs:{placeholder:"",clearable:""},model:{value:e.row.service_fee,callback:function(a){t.$set(e.row,"service_fee",a)},expression:"scope.row.service_fee"}})],1)]}}])}),t._v(" "),l("el-table-column",{attrs:{prop:"final_income",label:"息后税后收益分配（万元）",width:"230",sortable:""},scopedSlots:t._u([{key:"default",fn:function(e){return[t.currentIndex!=e.row.id?l("div",{},[t._v("\n\t\t\t\t\t\t\t\t\t"+t._s(e.row.final_income)+"\n\t\t\t\t\t\t\t\t")]):l("div",{},[l("el-input",{attrs:{placeholder:"",clearable:""},on:{input:function(a){t.calculate(e.$index)}},model:{value:e.row.final_income,callback:function(a){t.$set(e.row,"final_income",a)},expression:"scope.row.final_income"}})],1)]}}])}),t._v(" "),l("el-table-column",{attrs:{prop:"this_sum_distribution",label:"本次分配总额（万元）",width:"200",sortable:""}}),t._v(" "),l("el-table-column",{attrs:{prop:"last_sum_distribution",label:"上次累计分配总额（万元）",width:"230",sortable:""}}),t._v(" "),l("el-table-column",{attrs:{prop:"sum_distribution",label:"累计分配金额（万元）",width:"200",sortable:""}}),t._v(" "),l("el-table-column",{attrs:{fixed:"right",label:"操作",width:"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[t.currentIndex!=e.row.id?l("div",{},[l("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){t.editDetail(e.row)}}},[t._v("编辑")])],1):l("div",{},[l("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){t.editSaveDetail(e.row)}}},[t._v("保存")]),t._v(" "),l("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){t.editCancel(e.row)}}},[t._v("取消")])],1)]}}])}),t._v(" "),l("template",{slot:"empty"},[l("div",{staticClass:"table-nodata"},[l("img",{attrs:{src:a("urJZ")}}),t._v(" 没有对应数据\n\t\t\t\t\t\t\t")])])],2)],1)])])])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"cash_flow_table_title flex_between"},[e("div",{staticClass:"flex_start"},[e("span",{staticClass:"circle_blue"}),this._v(" "),e("span",{staticClass:"name"},[this._v("关联回款")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"cash_flow_table_title flex_between"},[e("div",{staticClass:"flex_start"},[e("span",{staticClass:"circle_blue"}),this._v(" "),e("span",{staticClass:"name"},[this._v("分配")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"cash_flow_table_title flex_between"},[e("div",{staticClass:"flex_start"},[e("span",{staticClass:"circle_blue"}),this._v(" "),e("span",{staticClass:"name"},[this._v("分配明细")])])])}]};var c=a("C7Lr")(o,r,!1,function(t){a("yZ1o")},"data-v-21d75b17",null);e.default=c.exports},yZ1o:function(t,e){}});
//# sourceMappingURL=184.270a606f1796cb684b43.js.map