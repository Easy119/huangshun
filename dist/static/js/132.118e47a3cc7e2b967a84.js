webpackJsonp([132],{"961q":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=i("a3Yh"),l=i.n(s),a=i("yclV"),c=i("2hMI"),n={data:function(){return{applyTypelist:[],routeList:[],visibleDialog:!1,template_id:"",filterText:"",visibleList:[],defaultProps:{children:"children",label:"name"},visibleCheckedall:!1,checkedVisibleStr:[],defaultChechedArr:[],allVisibleStr:[]}},created:function(){0!=this.routeList.length||(this.routeList=this.$route.meta.routeList),this.initdata()},components:{},computed:{},mounted:function(){},watch:{filterText:function(t){this.$refs.tree.filter(t)}},methods:l()({initdata:function(){var t=this;Object(c._134)({}).then(function(e){1==e.data.msgNo&&(t.applyTypelist=e.data.payload)})},getImgurl:function(t){t.currentTarget.src="../../static/images/header_userimg.png",t.onerror=null},changeTempstatus:function(t,e){var i=this,s="",l="";-1==e?(s="确认删除吗？",l="删除成功"):0==e?(s="确认停用吗？",l="停用成功"):1==e&&(s="确认启用吗？",l="启用成功"),Object(a.h)(s).then(function(s){Object(c.X)({tid:t,status:e}).then(function(t){1==t.data.msgNo?Object(a.g)("success",l):Object(a.g)("fail",t.data.message),i.initdata()})}).catch(function(){})},gotoApplytempProcess:function(t,e){this.$router.push({name:"applytempProcessNew",query:{template_id:t,type:e}})},gotoUpdateTemp:function(t){this.$router.push({name:"createApplyTemp",query:{id:t}})},changeVisible:function(t,e){this.visibleDialog=!0,this.template_id=e,this.filterText="",this.getUserRule(t)},getUserRule:function(t){var e=this;Object(c._235)({is_all:1}).then(function(i){if(1==i.data.msgNo){e.visibleList=i.data.payload;var s=i.data.payload,l=[];s.forEach(function(t){void 0!=t.children&&0!=t.children.length||(t.disabled=!0),t.id=-t.id,void 0!=t.children&&t.children.forEach(function(t){l.push(t.id)})}),e.allVisibleStr=l,e.visibleList=s,0!=t?((t=t.toString().split(",")).length==l.length?e.visibleCheckedall=!0:e.visibleCheckedall=!1,e.setCheckedKeyStr(t),e.$refs.tree.setCheckedKeys(t)):(e.visibleCheckedall=!1,e.checkedVisibleStr=[],e.$refs.tree.setCheckedKeys([]))}else Object(a.g)("fail",i.data.message)})},filterNode:function(t,e){return!t||-1!==e.name.toString().indexOf(t)},changeVisibleCheckedall:function(t){t?(this.$refs.tree.setCheckedKeys(this.allVisibleStr),this.setCheckedKeyStr(this.allVisibleStr)):(this.$refs.tree.setCheckedKeys([]),this.setCheckedKeyStr([]))},visivleListChange:function(t,e){var i=[];e.checkedNodes.forEach(function(t){if(void 0==t.children){var e={};e.id=t.id,e.url=t.url,e.name=t.name,i.push(e)}}),this.checkedVisibleStr=i,this.checkedVisibleStr.length==this.allVisibleStr.length?this.visibleCheckedall=!0:this.visibleCheckedall=!1},setCheckedKeyStr:function(t){var e=[];this.visibleList.forEach(function(i){void 0!=i.children&&(e=e.concat(i.children.filter(function(e){return-1!=t.indexOf(e.id.toString())||-1!=t.indexOf(e.id)})))}),this.checkedVisibleStr=e},compare:function(t){return function(e,i){return e[t]-i[t]}},deleteCheckedVisivle:function(t){var e=this;this.checkedVisibleStr.forEach(function(i,s){t==i.id&&e.checkedVisibleStr.splice(s,1)});var i=[];this.checkedVisibleStr.forEach(function(t,e){i.push(t.id)}),this.checkedVisibleStr.length==this.allVisibleStr.length?this.visibleCheckedall=!0:this.visibleCheckedall=!1,this.$refs.tree.setCheckedKeys(i)},commitVisible:function(){var t=this,e="";0==this.checkedVisibleStr.length||this.checkedVisibleStr.length==this.allVisibleStr.length?e=0:(e=[],this.checkedVisibleStr.forEach(function(t){e.push(t.id)})),e=e.toString(),Object(c._373)({tid:this.template_id,visible:e}).then(function(e){1==e.data.msgNo?(Object(a.g)("success","修改成功！"),t.visibleDialog=!1,t.initdata()):Object(a.g)("info",e.data.message)})},gotoCreatetemp:function(){this.$router.push({name:"createApplyTemp"})},visibleClose:function(){this.template_id="",this.checkedVisibleStr=[],this.$refs.tree.setCheckedKeys([]),this.visibleCheckedall=!1,this.visibleDialog=!1}},"getImgurl",function(t){t.currentTarget.src="../../static/images/header_userimg.png",t.onerror=null})},r={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"personal-content-body"},[s("div",{staticClass:"content"},[s("div",{staticClass:"content-title flex_between"},[s("div",{},[s("div",{staticClass:"table-group-title-btn btn-blue",on:{click:t.gotoCreatetemp}},[s("span",{staticClass:"iconfont icon-jia"}),t._v("新建审批模版")])])]),t._v(" "),s("div",{staticClass:"applytemp_body"},[0==t.applyTypelist.length?s("div",{staticClass:"table-nodata"},[s("img",{attrs:{src:i("urJZ")}}),t._v(" 没有对应数据\n\t\t\t\t")]):t._l(t.applyTypelist,function(e){return s("div",{staticClass:"applytemp_group"},[s("div",{staticClass:"applytemp_group_title"},[s("div",{staticClass:"applytemp_group_title_left"},[t._v("\n\t\t\t\t\t\t\t"+t._s(e.title)),s("span",{staticClass:"fcolor_gray"},[t._v("（"+t._s(e.children.length)+"）")])])]),t._v(" "),s("div",{staticClass:"applytemp_list"},t._l(e.children,function(i){return s("div",{staticClass:"applytemp_item"},[s("div",{staticClass:"applytemp_item_row flex"},[s("img",{staticClass:"applytemp_item_img",attrs:{src:i.url}}),t._v(" "),s("div",{staticClass:"flex_column flex_grow"},[s("div",{staticClass:"fsize_15 lineheight_1.5"},[t._v(t._s(i.name))]),t._v(" "),s("div",{staticClass:"fsize_12 fcolor_gray_85 applytemp_item_ellipsis lineheight_2"},[t._v("\n\t\t\t\t\t\t\t\t\t\t"+t._s(i.description)+"\n\t\t\t\t\t\t\t\t\t")]),t._v(" "),s("div",{staticClass:"fsize_12 fcolor_gray_85 lineheight_2"},[t._v(t._s(i.update_time)+" 更新")])]),t._v(" "),s("div",{staticClass:"line"})]),t._v(" "),s("div",{staticClass:"applytemp_item_row flex flex_grow"},[s("div",{staticClass:"fsize_14 flex_column flex_grow"},[s("div",{staticClass:"fsize_12 lineheight_2"},[t._v("可见范围")]),t._v(" "),s("div",{staticClass:"fsize_12 fcolor_gray_85"},[0==i.visible?s("span",{staticClass:"marginr_5 fcolor_gray_85 lineheight_2"},[t._v("全部可见")]):t._e(),t._v(" "),0!=i.visible?s("span",{staticClass:"marginr_5 fcolor_gray_85 lineheight_2"},[t._v("部分可见")]):t._e(),t._v(" "),s("span",{staticClass:"applytemp_item_link lineheight_2",on:{click:function(e){t.changeVisible(i.visible,i.id)}}},[t._v("修改")])])]),t._v(" "),s("div",{staticClass:"line"})]),t._v(" "),s("div",{staticClass:"applytemp_item_row flex flex_grow"},[s("div",{staticClass:"fsize_12 applytemp_item_link marginr_5",on:{click:function(s){t.gotoApplytempProcess(i.id,e.type)}}},[t._v("审批流程")]),t._v(" "),0==i.status?s("div",{staticClass:"fsize_12 applytemp_item_link marginr_5",on:{click:function(e){t.changeTempstatus(i.id,1)}}},[t._v("启用")]):t._e(),t._v(" "),1==i.status?s("div",{staticClass:"fsize_12 applytemp_item_link marginr_5",on:{click:function(e){t.changeTempstatus(i.id,0)}}},[t._v("停用")]):t._e(),t._v(" "),s("div",{staticClass:"fsize_12 applytemp_item_link marginr_5",on:{click:function(e){t.gotoUpdateTemp(i.id)}}},[t._v("编辑")]),t._v(" "),s("div",{staticClass:"fsize_12 applytemp_item_link marginr_5",on:{click:function(e){t.changeTempstatus(i.id,-1)}}},[t._v("删除")])])])}))])})],2),t._v(" "),s("el-dialog",{staticClass:"choosePeopleDialog",attrs:{title:"设置可见人员",visible:t.visibleDialog,width:"800px",center:"","append-to-body":!0,"before-close":t.visibleClose},on:{"update:visible":function(e){t.visibleDialog=e}}},[s("div",{staticClass:"dialog_content flex"},[s("div",{staticClass:"dialog_content_content"},[s("div",{staticClass:"dialog_content_content_title"},[t._v("选择人员")]),t._v(" "),s("div",[s("el-input",{attrs:{placeholder:"输入关键字进行过滤"},model:{value:t.filterText,callback:function(e){t.filterText=e},expression:"filterText"}},[s("i",{staticClass:"el-input__icon el-icon-search",attrs:{slot:"prefix"},slot:"prefix"})])],1),t._v(" "),s("div",{staticClass:"custom_tree_node flex"},[s("el-checkbox",{on:{change:t.changeVisibleCheckedall},model:{value:t.visibleCheckedall,callback:function(e){t.visibleCheckedall=e},expression:"visibleCheckedall"}},[t._v("全选")])],1),t._v(" "),s("el-tree",{ref:"tree",staticClass:"dialog_content_content_tree",attrs:{data:t.visibleList,"show-checkbox":"","node-key":"id","default-checked-keys":t.defaultChechedArr,"filter-node-method":t.filterNode,props:t.defaultProps},on:{check:t.visivleListChange},scopedSlots:t._u([{key:"default",fn:function(e){var i=e.node;return e.data,s("span",{staticClass:"custom_tree_node flex"},[void 0!=i.data.url?s("img",{attrs:{src:i.data.url},on:{error:t.getImgurl}}):t._e(),t._v("\n              "+t._s(i.data.name)+"\n            ")])}}])})],1),t._v(" "),s("div",{staticClass:"dialog_content_content"},[s("div",{staticClass:"dialog_content_content_title"},[t._v("已选人员")]),t._v(" "),s("div",{staticClass:"selected_list"},t._l(t.checkedVisibleStr,function(e){return s("div",{staticClass:"selected_item"},[s("img",{staticClass:"selected_item_headimg",attrs:{src:e.url},on:{error:t.getImgurl}}),t._v(t._s(e.name)+"\n\t\t\t\t\t\t\t\t"),s("i",{staticClass:"el-icon-error",on:{click:function(i){t.deleteCheckedVisivle(e.id)}}})])}))])]),t._v(" "),s("div",{staticClass:"dialog_footer clear",attrs:{slot:"footer"},slot:"footer"},[s("button",{staticClass:"dialog-btn-submit btn-blue",on:{click:t.commitVisible}},[t._v("确定")]),t._v(" "),s("button",{staticClass:"dialog-btn-submit btn-blue-border ",on:{click:t.visibleClose}},[t._v("取消")])])])],1)])},staticRenderFns:[]};var o=i("C7Lr")(n,r,!1,function(t){i("GZRC")},"data-v-51d4ed12",null);e.default=o.exports},GZRC:function(t,e){}});
//# sourceMappingURL=132.118e47a3cc7e2b967a84.js.map