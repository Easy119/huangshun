webpackJsonp([103],{FhVo:function(t,i,e){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var n=e("HzJ8"),a=e.n(n),s=e("3cXf"),o=e.n(s),l=e("2hMI"),c=e("lKYg"),r=e("aiqZ"),m=e("yclV"),d=(e("9rMa"),{data:function(){return{oldSelectcompnay:[],needChangeId:!0,editorconfirm:!1,companyList:[],loading:!1,commitData:{title:"",company:"",content:""},totalCompanyList:[],positionList:[],selectCompanyId:"",selectPositionId:"",selectCompanyList:[],historyFile:[],newFile:[],currentspan:"",editorOption:{modules:{toolbar:[["bold","italic"],[{header:1}],[{list:"ordered"},{list:"bullet"}],[{size:["small",!1,"large","huge"]}],[{color:[]}],[{align:[]}],["clean"],["link","image"]],syntax:{highlight:function(t){return hljs.highlightAuto(t).value}}},placeholder:""}}},components:{progressBar:c.a,quillEditor:r.quillEditor},computed:{submitOk:function(){return""!=this.commitData.title&&""!=this.commitData.content}},mounted:function(){},created:function(){void 0!=this.$route.query.aif&&(this.editorconfirm=!0),this.initData()},methods:{showCompanyInfo:function(){var t=this;Object(l._208)({company_id:this.selectCompanyId}).then(function(i){1==i.data.msgNo?(t.positionList=i.data.payload,t.selectPositionId=""):Object(m.g)("info",i.data.message)})},addSelectCompanyList:function(){var t=this;if(""==this.selectPositionId)Object(m.g)("info","请先选择职位");else{var i={companyInfo:{},positionArr:[]},e={},n=!0,a=!1;if(this.positionList.forEach(function(i){i.position_id==t.selectPositionId&&(null==(e=JSON.parse(o()(i))).name||void 0==e.name?(Object(m.g)("info","该职位还未安排人员"),a=!0):e.name=e.name.split(","))}),a)return!1;this.selectCompanyList.forEach(function(i){if(i.companyInfo.id==t.selectCompanyId){n=!1;var a=!0;i.positionArr.forEach(function(i){i.position_id==t.selectPositionId&&(a=!1,Object(m.g)("info","该职位已添加!"))}),a&&i.positionArr.push(e)}}),n&&(this.totalCompanyList.forEach(function(n){n.id==t.selectCompanyId&&(i.companyInfo=n,i.positionArr.push(e))}),this.selectCompanyList.push(i)),this.selectCompanyId="",this.selectPositionId="",this.positionList=[]}},deleteSelectCompanyList:function(t,i){console.log(this.selectCompanyList),this.selectCompanyList.splice(i,1)},deleteOnePosition:function(t,i){console.log(t),console.log(i),t.splice(i,1)},initData:function(){var t=this;Object(l._12)().then(function(i){if(1==i.data.msgNo){var e=i.data.payload;t.totalCompanyList=e,void 0!=t.$route.query.aif&&t.getNewsDetail()}})},addFile:function(t){var i=!0,e=!1,n=void 0;try{for(var s,o=a()(t.target.files);!(i=(s=o.next()).done);i=!0){var l=s.value,c=!0,r=!0,m=!1,d=void 0;try{for(var f,u=a()(this.newFile);!(r=(f=u.next()).done);r=!0){f.value.name==l.name&&(c=!1)}}catch(t){m=!0,d=t}finally{try{!r&&u.return&&u.return()}finally{if(m)throw d}}c&&this.newFile.push(l)}}catch(t){e=!0,n=t}finally{try{!i&&o.return&&o.return()}finally{if(e)throw n}}t.target.value=""},remoteMethod:function(t){var i=this;""!==t?(this.loading=!0,setTimeout(function(){if(i.loading=!1,i.companyList=i.totalCompanyList.filter(function(i){return i.name.indexOf(t)>-1}),i.companyList.length>0)for(var e in i.commitData.companyId){var n=!0,s=!1,o=void 0;try{for(var l,c=a()(i.companyList);!(n=(l=c.next()).done);n=!0){var r=l.value;r.name==i.commitData.companyId[e]&&(i.commitData.companyId[e]=r.id)}}catch(t){s=!0,o=t}finally{try{!n&&c.return&&c.return()}finally{if(s)throw o}}}},200)):this.companyList=[]},getNewsDetail:function(){var t=this;Object(l._326)({aif:this.$route.query.aif}).then(function(i){if(1==i.data.msgNo){var e=i.data.payload;t.commitData.title=e.info.title,t.commitData.content=e.info.contents,t.editorconfirm&&""!=e.info.adjunct&&(t.commitData.adjunct=JSON.parse(e.info.adjunct));var n=[];e.company.forEach(function(t){var i={companyInfo:{},positionArr:[]};i.companyInfo.name=t.company_name,i.companyInfo.id=t.company_id,(null!=t.position_id&&""!=t.position_id||void 0!=t.position_id)&&(t.pasition_arr.forEach(function(t){""!=t.name&&null!=t.name?t.name=t.name.split(","):t.name=[]}),i.positionArr=t.pasition_arr),n.push(i)}),t.selectCompanyList=n}})},commitClick:function(){var t=this;if(this.submitOk){var i="",e={title:this.commitData.title,contents:this.commitData.content};0!=this.selectCompanyList.length&&(i=[],this.selectCompanyList.forEach(function(t){var e={};e.company_id=t.companyInfo.id;var n=[];t.positionArr.forEach(function(t){n.push(t.position_id)}),e.position_id=n.join(","),i.push(e)}),e.company=o()(i)),Object(l._302)(e,this.newFile).then(function(i){console.log(i),1==i.data.msgNo&&(Object(m.g)("success","发布成功"),t.goNewList())})}else Object(m.g)("info","您还有必填项没有填写！")},changeCommitClick:function(){var t=this;if(this.submitOk){var i="",e={title:this.commitData.title,contents:this.commitData.content,aif:this.$route.query.aif};void 0!=this.commitData.adjunct&&(e.adjunct=o()(this.commitData.adjunct)),0!=this.selectCompanyList.length&&(i=[],this.selectCompanyList.forEach(function(t){var e={};e.company_id=t.companyInfo.id;var n=[];t.positionArr.forEach(function(t){n.push(t.position_id)}),e.position_id=n.join(","),i.push(e)}),e.company=o()(i)),Object(l._89)(e,this.newFile).then(function(i){1==i.data.msgNo&&(Object(m.g)("success","编辑成功"),t.goNewList())})}else Object(m.g)("info","您还有必填项没有填写！")},changeOldFile:function(t,i){var e=JSON.parse(o()(this.commitData.adjunct));delete e[t],this.commitData.adjunct=e;var n=!0,s=!1,l=void 0;try{for(var c,r=a()(i.target.files);!(n=(c=r.next()).done);n=!0){var m=c.value;this.newFile.push(m)}}catch(t){s=!0,l=t}finally{try{!n&&r.return&&r.return()}finally{if(s)throw l}}i.target.value=""},deleteOldFile:function(t){var i=JSON.parse(o()(this.commitData.adjunct));delete i[t],this.commitData.adjunct=i},changeNewFile:function(t,i){this.newFile.splice(t,1);var e=!0,n=!1,s=void 0;try{for(var o,l=a()(i.target.files);!(e=(o=l.next()).done);e=!0){var c=o.value;this.newFile.push(c)}}catch(t){n=!0,s=t}finally{try{!e&&l.return&&l.return()}finally{if(n)throw s}}i.target.value=""},deleteNewFile:function(t){this.newFile.splice(t,1)},goNewList:function(){this.$router.push({path:"/home/investedPublishNews"})}}}),f={render:function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("div",{staticClass:"personal-content-body"},[e("div",{staticClass:"content investPersonaInfoPublish scroll-style"},[t._m(0),t._v(" "),e("div",{staticClass:"content-body clear"},[e("div",{staticClass:"content-body-left-box left"},[e("div",{staticClass:"content-body-left-box-title"},[e("div",{staticClass:"clear"},[e("div",{staticClass:"text-nav breadcrumb left"},[e("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[e("el-breadcrumb-item",{attrs:{to:{path:"/home/investedPublishNews"}}},[t._v("公告发布")]),t._v(" "),e("el-breadcrumb-item",[t._v("编辑页")])],1)],1)]),t._v(" "),e("div",{staticClass:"line"})]),t._v(" "),e("div",{staticClass:"content-body-left-box-content"},[e("div",{staticClass:"content-part-box"},[e("div",{staticClass:"content-part-body"},[e("div",{staticClass:"form-group from-inputbox clear"},[t._m(1),t._v(" "),e("div",{staticClass:"form-input left"},[e("el-input",{staticClass:"header-right-time input-position",attrs:{placeholder:"请输入文章标题",clearable:!0},model:{value:t.commitData.title,callback:function(i){t.$set(t.commitData,"title",i)},expression:"commitData.title"}})],1)]),t._v(" "),e("div",{staticClass:"form-group from-inputbox clear"},[t._m(2),t._v(" "),e("div",{staticClass:"form-input left"},[e("el-select",{staticClass:"header-right-time right",attrs:{placeholder:"请选择公司",filterable:""},on:{change:t.showCompanyInfo},model:{value:t.selectCompanyId,callback:function(i){t.selectCompanyId=i},expression:"selectCompanyId"}},t._l(t.totalCompanyList,function(t){return e("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})})),t._v(" "),e("el-select",{staticClass:"header-right-time left selectPosition",attrs:{placeholder:"请选择职位"},model:{value:t.selectPositionId,callback:function(i){t.selectPositionId=i},expression:"selectPositionId"}},t._l(t.positionList,function(t){return e("el-option",{key:t.position_id,attrs:{label:t.position,value:t.position_id}})})),t._v(" "),e("div",{staticClass:"content-confirm-btn btn-blue right addSelectPosition",on:{click:t.addSelectCompanyList}},[t._v("添加")]),t._v(" "),t._l(t.selectCompanyList,function(i,n){return e("div",{key:n,staticClass:"show-select-companyInfo left"},[e("div",{staticClass:"line_company_title"},[e("span",{staticClass:"icon"}),t._v(" "),e("span",{staticClass:"companyName"},[t._v(t._s(i.companyInfo.name))]),t._v(" "),e("span",{staticClass:"deleteBtn right",on:{click:function(e){t.deleteSelectCompanyList(i,n)}}})]),t._v(" "),e("div",{staticClass:"line_person_list_box"},t._l(i.positionArr,function(n,a){return e("div",{key:a,staticClass:"line_person_list"},[e("div",{staticClass:"line_person_list_left"},[e("span",{staticClass:"icon"}),t._v(" "),e("span",{staticClass:"position"},[t._v(t._s(n.position)+"：")])]),t._v(" "),e("div",{staticClass:"line_person_list_right"},t._l(n.name,function(i,n){return e("span",{key:n,staticClass:"left"},[t._v(t._s(i))])})),t._v(" "),e("span",{staticClass:"deleteBtn right",on:{click:function(e){t.deleteOnePosition(i.positionArr,a)}}})])}))])})],2)]),t._v(" "),e("div",{staticClass:"form-group from-inputbox clear"},[t._m(3),t._v(" "),e("div",{staticClass:"form-input form-filebox left"},[e("div",{staticClass:"file-list"},[t._l(t.commitData.adjunct,function(i,n){return t.editorconfirm?e("div",{key:n,staticClass:"file-item"},[e("div",{staticClass:"file-name"},[e("div",[t._v(t._s(n))])]),t._v(" "),e("a",{staticClass:"formgroup-file-item-btn right"},[e("input",{staticClass:"formgroup-file-item-btn-inputfile",attrs:{type:"file",multiple:"multiple"},on:{change:function(i){t.changeOldFile(n,i)}}}),t._v("替换")]),t._v(" "),e("div",{staticClass:"file-click file-click-del",on:{click:function(i){t.deleteOldFile(n)}}},[t._v("删除")])]):t._e()}),t._v(" "),t._l(t.newFile,function(i,n){return e("div",{key:n,staticClass:"file-item"},[e("div",{staticClass:"file-name"},[e("div",[t._v(t._s(i.name))])]),t._v(" "),e("a",{staticClass:"formgroup-file-item-btn right"},[e("input",{staticClass:"formgroup-file-item-btn-inputfile",attrs:{type:"file",multiple:"multiple"},on:{change:function(i){t.changeNewFile(n,i)}}}),t._v("替换")]),t._v(" "),e("div",{staticClass:"file-click file-click-del",on:{click:function(i){t.deleteNewFile(n)}}},[t._v("删除")])])})],2),t._v(" "),e("div",{staticClass:"file-add"},[e("input",{staticClass:"file-add-input",attrs:{type:"file",multiple:"multiple"},on:{change:function(i){t.addFile(i)}}}),t._v(" "),e("i",{staticClass:"el-icon-plus"}),t._v("添加文件\n                  ")])])]),t._v(" "),e("div",{staticClass:"form-group from-inputbox clear form-editorbox"},[t._m(4),t._v(" "),e("div",{staticClass:"form-input left"},[e("quill-editor",{ref:"myQuillEditor",staticClass:"form-editor",attrs:{options:t.editorOption},model:{value:t.commitData.content,callback:function(i){t.$set(t.commitData,"content",i)},expression:"commitData.content"}})],1)])])]),t._v(" "),e("div",{staticClass:"content-confirm clear"},[0==t.editorconfirm?e("div",{staticClass:"content-confirm-btn btn-blue",class:{"btn-blue-disabled":!t.submitOk},on:{click:t.commitClick}},[t._v("发布")]):t._e(),t._v(" "),1==t.editorconfirm?e("div",{staticClass:"content-confirm-btn btn-blue",class:{"btn-blue-disabled":!t.submitOk},on:{click:t.changeCommitClick}},[t._v("发布")]):t._e()])])])])])])},staticRenderFns:[function(){var t=this.$createElement,i=this._self._c||t;return i("div",{staticClass:"content-title clear"},[i("div",{staticClass:"left"},[this._v("公告发布")])])},function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("div",{staticClass:"form-title left"},[e("em",{staticClass:"red"},[t._v("*")]),t._v(" "),e("em",[t._v("文")]),t._v(" "),e("em",[t._v("章")]),t._v(" "),e("em",[t._v("标")]),t._v(" "),e("em",[t._v("题")])])},function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("div",{staticClass:"form-title left"},[e("em",{staticClass:"red"},[t._v(" ")]),t._v(" "),e("em",[t._v("发")]),t._v(" "),e("em",[t._v("送")]),t._v(" "),e("em",[t._v("对")]),t._v(" "),e("em",[t._v("像")])])},function(){var t=this.$createElement,i=this._self._c||t;return i("div",{staticClass:"form-title left"},[i("em",[this._v("附")]),this._v(" "),i("em",[this._v("件")])])},function(){var t=this.$createElement,i=this._self._c||t;return i("div",{staticClass:"form-title left"},[i("em",{staticClass:"red"},[this._v("*")]),this._v(" "),i("em",[this._v("正")]),this._v(" "),i("em",[this._v("文")])])}]};var u=e("C7Lr")(d,f,!1,function(t){e("ao9p")},"data-v-69e831e4",null);i.default=u.exports},ao9p:function(t,i){}});
//# sourceMappingURL=103.805e56620c721f91d6bb.js.map