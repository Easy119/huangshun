webpackJsonp([205],{"8UmZ":function(t,i,o){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var a=o("3cXf"),e=o.n(a),s=o("2hMI"),n=o("yclV"),r={data:function(){return{type:1,projInfo:"",list:[],pageSize:10,keyWord:null,total:null,currentPage:1,projectId:"",fileuploadDialog:!1,companyList:[],positionList:[],id:"",name:"",phone:"",email:"",company_id:"",position_id:"",nameErrorMsg:"",phoneErrorMsg:"",companyErrorMsg:"",positionErrorMsg:"",emailErrorMsg:"",alertType:"add",alertTitle:"添加账号",canConfirm:!0,canSave:!1,notConfim:!0}},computed:{nameReg:function(){return!this.notConfim&&((""==this.name||void 0==this.name)&&(this.nameErrorMsg="*姓名不能为空",!0))},phoneReg:function(){if(this.notConfim)return!1;return""==this.phone||void 0==this.phone?(this.phoneErrorMsg="*手机号不能为空",!0):!/^1[34578]\d{9}$/.test(this.phone)&&(this.phoneErrorMsg="*手机号码格式不正确",!0)},companyReg:function(){return!this.notConfim&&((""==this.company_id||void 0==this.company_id)&&(this.companyErrorMsg="*请选择公司",!0))},positionReg:function(){return!this.notConfim&&((""==this.position_id||void 0==this.position_id||null==this.position_id)&&(this.positionMsg="*职位不能为空",!0))},emailReg:function(){if(this.notConfim)return!1;return""!=this.email&&void 0!=this.email&&(!/^([a-zA-Z0-9_\.\-])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/.test(this.email)&&(this.emailErrorMsg="*邮箱格式不正确",!0))}},watch:{$route:function(t,i){this.initData()}},mounted:function(){this.initData()},methods:{initData:function(){var t=this;void 0==this.$route.query.projectId||""==this.$route.query.projectId?(this.projectId="",this.type=1):(this.projectId=this.$route.query.projectId,this.type=2,Object(s._300)({page:1,number:10,id:this.projectId}).then(function(i){1==i.data.msgNo&&(t.projInfo=i.data.payload.data[0])})),this.getListData(1),this.getCompanyList()},currentChange:function(t){this.total>this.pageSize&&this.getListData(t)},getCompanyList:function(){var t=this;Object(s._12)().then(function(i){1==i.data.msgNo&&(t.companyList=i.data.payload)})},getListData:function(t){var i=this;this.list=[],this.currentPage=t;var o={page:t,number:this.pageSize};""!=this.projectId&&(o.projectId=this.projectId),null!=this.keyWord&&""!=this.keyWord&&(o.search=this.keyWord),Object(s._143)(o).then(function(t){var o=t.data.payload;i.total=o.total,0!=o.data.length&&(i.list=o.data)})},inputChange:function(){this.canSave=!0},dataChange:function(t){var i=this;1!=t&&(this.canSave=!0),""!=this.company_id&&null!=this.company_id&&void 0!=this.company_id&&Object(s._208)({company_id:this.company_id}).then(function(t){1==t.data.msgNo?i.positionList=t.data.payload:Object(n.g)("info",t.data.message)})},alterAdd:function(){this.fileuploadDialog=!0,this.alertType="add",this.alertTitle="添加联系人",this.name="",this.phone="",this.company_id="",this.position_id="",this.email="",this.nameErrorMsg="",this.phoneErrorMsg="",this.companyErrorMsg="",this.positionErrorMsg="",this.emailErrorMsg="",this.positionList=[],this.notConfim=!0},toAddAccount:function(){var t=this;if(this.notConfim=!1,!(this.nameReg||this.phoneReg||this.positionReg||this.emailReg||this.companyReg)){var i={name:this.name,phone:this.phone,email:this.email,position_id:this.position_id,company_id:this.company_id};"string"==typeof i.position_id&&(i.position_id=0,i.position=this.position_id),Object(s.w)(i).then(function(i){1==i.data.msgNo?(t.getListData(1),Object(n.g)("success","联系人添加成功"),t.fileuploadDialog=!1,t.canSave=!1):Object(n.g)("info",i.data.message)})}},alterEditor:function(t){this.fileuploadDialog=!0,this.alertType="editor",this.alertTitle="修改联系人信息";var i=JSON.parse(e()(t));this.name=i.name,this.phone=i.phone,this.company_id=i.company_id,this.position_id=i.position_id,this.email=i.email,this.id=i.id,this.nameErrorMsg="",this.phoneErrorMsg="",this.companyErrorMsg="",this.positionErrorMsg="",this.emailErrorMsg="",this.notConfim=!0,this.dataChange(1)},toEditAccount:function(){var t=this;if(this.notConfim=!1,!(this.nameReg||this.phoneReg||this.positionReg||this.emailReg||this.companyReg)){var i={id:this.id,name:this.name,phone:this.phone,email:this.email,position_id:this.position_id,company_id:this.company_id};"string"==typeof i.position_id&&(i.position_id=0,i.position=this.position_id),Object(s.w)(i).then(function(i){1==i.data.msgNo?(t.getListData(t.currentPage),Object(n.g)("success","联系人修改成功"),t.fileuploadDialog=!1,t.canSave=!1):Object(n.g)("info",i.data.message)})}},toCancleConfirm:function(){var t=this;this.canSave?Object(n.h)("确定不保存退出么？").then(function(){t.canSave=!1,t.fileuploadDialog=!1}).catch(function(){}):this.fileuploadDialog=!1}}},l={render:function(){var t=this,i=t.$createElement,a=t._self._c||i;return a("div",{staticClass:"personal-content-body"},[a("div",{staticClass:"content"},[a("div",{staticClass:"content-title clear"},[a("div",{staticClass:"left"},[t._v("项目联系人管理")]),t._v(" "),a("el-input",{staticClass:"header-right-time right",attrs:{placeholder:"搜索",clearable:!0},on:{change:function(i){t.getListData(1)}},model:{value:t.keyWord,callback:function(i){t.keyWord=i},expression:"keyWord"}},[a("i",{staticClass:"el-input__icon el-icon-search ",attrs:{slot:"prefix"},slot:"prefix"})])],1),t._v(" "),a("div",{staticClass:"historyapply-group"},[a("div",{staticClass:"clear table-group-title"},[a("div",{staticClass:"left breadcrumb"},[a("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[2==t.type?a("el-breadcrumb-item",{attrs:{to:{path:"/home/investProjectManageHomepage",query:{id:t.projectId}}}},[t._v("返回项目首页")]):t._e(),t._v(" "),a("el-breadcrumb-item",[t._v(t._s(t.projInfo.name)+"联系人管理("+t._s(t.total)+"）")])],1)],1),t._v(" "),a("div",{staticClass:"right"},[a("div",{staticClass:"table-group-title-btn btn-blue",on:{click:function(i){t.alterAdd()}}},[a("span",{staticClass:"iconfont icon-add"}),t._v("添加联系人\n          ")])]),t._v(" "),a("div",{staticClass:"line"})]),t._v(" "),a("div",{staticClass:"historyapply-group-tablebox"},[a("div",{staticClass:"table-normal-box"},[a("table",{staticClass:"table-normal"},[t._m(0),t._v(" "),t._l(t.list,function(i,o){return a("tr",{key:i.index},[a("td",[t._v(t._s(t.pageSize*(t.currentPage-1)+o+1))]),t._v(" "),a("td",[t._v(t._s(i.name))]),t._v(" "),""==i.position||null==i.position?a("td",[t._v("---")]):a("td",[t._v(t._s(i.position))]),t._v(" "),""==i.email||null==i.email?a("td",[t._v("---")]):a("td",[t._v(t._s(i.email))]),t._v(" "),""==i.phone||null==i.phone?a("td",[t._v("---")]):a("td",[t._v(t._s(i.phone))]),t._v(" "),""==i.company_name||null==i.company_name?a("td",[t._v("---")]):a("td",[t._v(t._s(i.company_name))]),t._v(" "),""==i.add_time||null==i.add_time?a("td",[t._v("---")]):a("td",[t._v(t._s(i.add_time))]),t._v(" "),a("td",{staticClass:"creditCz-box",attrs:{width:"38"},on:{click:function(o){t.alterEditor(i)}}},[a("span",{staticClass:"table-link"},[t._v("管理")])])])})],2),t._v(" "),0==t.total?a("div",{staticClass:"table-nodata"},[a("img",{attrs:{src:o("urJZ")}}),t._v(" 没有对应数据\n          ")]):t._e()]),t._v(" "),0!=t.total?a("div",{staticClass:"pagination-normal"},[a("el-pagination",{attrs:{background:"",layout:"prev, pager, next",total:t.total,"page-size":t.pageSize,"prev-text":"上一页","next-text":"下一页","current-page":t.currentPage},on:{"current-change":t.currentChange}})],1):t._e()])]),t._v(" "),a("el-dialog",{attrs:{title:t.alertTitle,visible:t.fileuploadDialog,width:"900px",center:"","append-to-body":!0,"before-close":t.toCancleConfirm},on:{"update:visible":function(i){t.fileuploadDialog=i}}},[a("div",{staticClass:"dialog_content"},[a("div",{staticClass:"form-group margin-bottom-none"},[a("div",{staticClass:"form-group-inputboxgroup clear"},[a("div",{staticClass:"form-group-inputbox"},[a("h2",{staticClass:"form-group-inputbox-title"},[a("span",{staticClass:"account-icon icon-required"}),t._v("姓名")]),t._v(" "),a("div",{staticClass:"form-group-inputbox-selectbox select-normal-40 left"},[a("el-input",{staticClass:"header-right-time right",attrs:{placeholder:"请填写",clearable:!0},on:{change:t.inputChange},model:{value:t.name,callback:function(i){t.name=i},expression:"name"}})],1),t._v(" "),t.nameReg?a("span",{staticClass:"form-group-inputbox-error"},[t._v(t._s(t.nameErrorMsg))]):t._e()]),t._v(" "),a("div",{staticClass:"form-group-inputbox"},[a("h2",{staticClass:"form-group-inputbox-title"},[a("span",{staticClass:"account-icon icon-required"}),t._v("手机号")]),t._v(" "),a("div",{staticClass:"form-group-inputbox-selectbox select-normal-40 left"},[a("el-input",{staticClass:"header-right-time right",attrs:{placeholder:"请填写",clearable:!0,maxlength:"11"},on:{change:t.inputChange},model:{value:t.phone,callback:function(i){t.phone=i},expression:"phone"}})],1),t._v(" "),t.phoneReg?a("span",{staticClass:"form-group-inputbox-error"},[t._v(t._s(t.phoneErrorMsg))]):t._e()])]),t._v(" "),a("div",{staticClass:"form-group-inputboxgroup clear"},[a("div",{staticClass:"form-group-inputbox"},[a("h2",{staticClass:"form-group-inputbox-title"},[a("span",{staticClass:"account-icon icon-required"}),t._v("选择公司")]),t._v(" "),a("div",{staticClass:"form-group-inputbox-selectbox select-normal-40 left"},[a("el-select",{attrs:{placeholder:"请选择公司",filterable:"",clearable:!0},on:{change:t.dataChange},model:{value:t.company_id,callback:function(i){t.company_id=i},expression:"company_id"}},t._l(t.companyList,function(t){return a("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})}))],1),t._v(" "),t.companyReg?a("span",{staticClass:"form-group-inputbox-error"},[t._v(t._s(t.companyErrorMsg))]):t._e()]),t._v(" "),a("div",{staticClass:"form-group-inputbox"},[a("h2",{staticClass:"form-group-inputbox-title"},[a("span",{staticClass:"account-icon icon-required"}),t._v("职位")]),t._v(" "),a("div",{staticClass:"form-group-inputbox-selectbox select-normal-40 left"},[a("el-select",{attrs:{placeholder:"若无对应数据,职位可手动输入","allow-create":"","default-first-option":"",filterable:"",clearable:!0},on:{change:t.inputChange},model:{value:t.position_id,callback:function(i){t.position_id=i},expression:"position_id"}},t._l(t.positionList,function(t){return a("el-option",{key:t.position_id,attrs:{label:t.position,value:t.position_id}})}))],1),t._v(" "),t.positionReg?a("span",{staticClass:"form-group-inputbox-error"},[t._v(t._s(t.positionMsg))]):t._e()])]),t._v(" "),a("div",{staticClass:"form-group-inputboxgroup clear margin-bottom-none"},[a("div",{staticClass:"form-group-inputbox"},[a("h2",{staticClass:"form-group-inputbox-title"},[t._v("邮箱")]),t._v(" "),a("div",{staticClass:"form-group-inputbox-selectbox select-normal-40 left"},[a("el-input",{staticClass:"header-right-time right",attrs:{placeholder:"请填写",clearable:!0},on:{change:t.inputChange},model:{value:t.email,callback:function(i){t.email=i},expression:"email"}})],1),t._v(" "),t.emailReg?a("span",{staticClass:"form-group-inputbox-error"},[t._v(t._s(t.emailErrorMsg))]):t._e()])])])]),t._v(" "),a("div",{staticClass:"dialog_footer clear",attrs:{slot:"footer"},slot:"footer"},["add"==t.alertType?a("button",{staticClass:"dialog-btn-submit btn-blue",on:{click:t.toAddAccount}},[t._v("添加")]):t._e(),t._v(" "),"editor"==t.alertType?a("button",{staticClass:"dialog-btn-submit btn-blue",on:{click:t.toEditAccount}},[t._v("修改")]):t._e(),t._v(" "),a("button",{staticClass:"dialog-btn-submit btn-cancle",on:{click:t.toCancleConfirm}},[t._v("取消")])])])],1)])},staticRenderFns:[function(){var t=this,i=t.$createElement,o=t._self._c||i;return o("tr",[o("th",{attrs:{width:"30"}},[t._v("序号")]),t._v(" "),o("th",[t._v("姓名")]),t._v(" "),o("th",[t._v("职位")]),t._v(" "),o("th",[t._v("邮箱")]),t._v(" "),o("th",[t._v("手机号")]),t._v(" "),o("th",[t._v("所属公司")]),t._v(" "),o("th",[t._v("添加时间")]),t._v(" "),o("th",{attrs:{width:"38"}},[t._v("操作")])])}]};var c=o("C7Lr")(r,l,!1,function(t){o("e+f9")},"data-v-0b0a23d5",null);i.default=c.exports},"e+f9":function(t,i){}});
//# sourceMappingURL=205.e5471d7007853e20e1ae.js.map